<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Jurimetria - 7&nbsp; Modelos Lineares</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./outrosmodelos.html" rel="next">
<link href="./descritiva.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Jurimetria</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./intro.html" rel="" target="">
 <span class="menu-text">Introdução ao Feminicídio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./summary.html" rel="" target="">
 <span class="menu-text">Sumário do Curso</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./pesquisa.html" rel="" target="">
 <span class="menu-text">Direito e a Ciência de Dados</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./interpretando.html" rel="" target="">
 <span class="menu-text">Interpretando os Resultados</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lineares.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Modelos Lineares</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prefácio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introdução ao Feminicídio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sumário do Curso</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pesquisa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Direito e a Ciência de Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipulacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulação de Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descritiva.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Análise Descritiva</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lineares.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Modelos Lineares</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./outrosmodelos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Outros Modelos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aprendizado.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Aprendizado de Máquina</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interpretando.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Interpretando os Resultados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dicionario.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dicionário de Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#regressão-linear-simples---rls" id="toc-regressão-linear-simples---rls" class="nav-link active" data-scroll-target="#regressão-linear-simples---rls"><span class="header-section-number">8</span> Regressão Linear Simples - RLS</a>
  <ul class="collapse">
  <li><a href="#introdução" id="toc-introdução" class="nav-link" data-scroll-target="#introdução"><span class="header-section-number">8.1</span> Introdução</a>
  <ul class="collapse">
  <li><a href="#alguns-exemplos-de-regressão-aplicados-ao-contexto-jurídico" id="toc-alguns-exemplos-de-regressão-aplicados-ao-contexto-jurídico" class="nav-link" data-scroll-target="#alguns-exemplos-de-regressão-aplicados-ao-contexto-jurídico"><span class="header-section-number">8.1.1</span> Alguns Exemplos de Regressão Aplicados ao Contexto Jurídico:</a></li>
  </ul></li>
  <li><a href="#hipóteses-sobre-o-comportamento-do-termo-de-erro" id="toc-hipóteses-sobre-o-comportamento-do-termo-de-erro" class="nav-link" data-scroll-target="#hipóteses-sobre-o-comportamento-do-termo-de-erro"><span class="header-section-number">8.2</span> Hipóteses sobre o comportamento do Termo de Erro</a></li>
  <li><a href="#estimação-dos-parâmetros-da-rls" id="toc-estimação-dos-parâmetros-da-rls" class="nav-link" data-scroll-target="#estimação-dos-parâmetros-da-rls"><span class="header-section-number">8.3</span> Estimação dos Parâmetros da RLS</a>
  <ul class="collapse">
  <li><a href="#aplicação---estimando-uma-regressão-linear-simples" id="toc-aplicação---estimando-uma-regressão-linear-simples" class="nav-link" data-scroll-target="#aplicação---estimando-uma-regressão-linear-simples"><span class="header-section-number">8.3.1</span> Aplicação - Estimando uma Regressão Linear Simples</a></li>
  </ul></li>
  <li><a href="#caracteristicas-do-método-dos-mínimos-quadrados-ordinários-em-determinadas-amostras-de-dados" id="toc-caracteristicas-do-método-dos-mínimos-quadrados-ordinários-em-determinadas-amostras-de-dados" class="nav-link" data-scroll-target="#caracteristicas-do-método-dos-mínimos-quadrados-ordinários-em-determinadas-amostras-de-dados"><span class="header-section-number">8.4</span> Caracteristicas do Método dos Mínimos Quadrados Ordinários em Determinadas Amostras de Dados</a>
  <ul class="collapse">
  <li><a href="#valores-estimados-e-resíduos" id="toc-valores-estimados-e-resíduos" class="nav-link" data-scroll-target="#valores-estimados-e-resíduos"><span class="header-section-number">8.4.1</span> Valores estimados e Resíduos</a></li>
  <li><a href="#propriedades-algébricas-do-mqo" id="toc-propriedades-algébricas-do-mqo" class="nav-link" data-scroll-target="#propriedades-algébricas-do-mqo"><span class="header-section-number">8.4.2</span> Propriedades Algébricas do MQO</a></li>
  <li><a href="#qualidade-do-ajuste" id="toc-qualidade-do-ajuste" class="nav-link" data-scroll-target="#qualidade-do-ajuste"><span class="header-section-number">8.4.3</span> Qualidade do Ajuste</a></li>
  </ul></li>
  <li><a href="#ausência-de-viés-e-variância-dos-estimadores-de-mqo" id="toc-ausência-de-viés-e-variância-dos-estimadores-de-mqo" class="nav-link" data-scroll-target="#ausência-de-viés-e-variância-dos-estimadores-de-mqo"><span class="header-section-number">8.5</span> Ausência de Viés e Variância dos Estimadores de MQO</a>
  <ul class="collapse">
  <li><a href="#ausencia-de-viés-em-mqo" id="toc-ausencia-de-viés-em-mqo" class="nav-link" data-scroll-target="#ausencia-de-viés-em-mqo"><span class="header-section-number">8.5.1</span> Ausencia de Viés em MQO</a></li>
  <li><a href="#variância-dos-estimadores-de-mqo" id="toc-variância-dos-estimadores-de-mqo" class="nav-link" data-scroll-target="#variância-dos-estimadores-de-mqo"><span class="header-section-number">8.5.2</span> Variância dos estimadores de MQO</a></li>
  <li><a href="#estimação-da-variância-do-erro" id="toc-estimação-da-variância-do-erro" class="nav-link" data-scroll-target="#estimação-da-variância-do-erro"><span class="header-section-number">8.5.3</span> Estimação da Variância do erro</a></li>
  </ul></li>
  <li><a href="#aplicação-de-rls---foco-no-erro-padrão-do-parametro-b1" id="toc-aplicação-de-rls---foco-no-erro-padrão-do-parametro-b1" class="nav-link" data-scroll-target="#aplicação-de-rls---foco-no-erro-padrão-do-parametro-b1"><span class="header-section-number">8.6</span> Aplicação de RLS - Foco no erro padrão do parametro b1</a></li>
  </ul></li>
  <li><a href="#regressão-linear-múltipla-rlm" id="toc-regressão-linear-múltipla-rlm" class="nav-link" data-scroll-target="#regressão-linear-múltipla-rlm"><span class="header-section-number">9</span> Regressão Linear Múltipla (RLM)</a>
  <ul class="collapse">
  <li><a href="#exemplos-de-regressão-multipla-no-contexto-jurídico" id="toc-exemplos-de-regressão-multipla-no-contexto-jurídico" class="nav-link" data-scroll-target="#exemplos-de-regressão-multipla-no-contexto-jurídico"><span class="header-section-number">9.1</span> Exemplos de Regressão Multipla no Contexto Jurídico</a></li>
  <li><a href="#a-interpretação-da-equação-de-regressão-de-mqo" id="toc-a-interpretação-da-equação-de-regressão-de-mqo" class="nav-link" data-scroll-target="#a-interpretação-da-equação-de-regressão-de-mqo"><span class="header-section-number">9.2</span> A Interpretação da Equação de Regressão de MQO</a></li>
  <li><a href="#estimação-dos-k-parametros-na-rlm" id="toc-estimação-dos-k-parametros-na-rlm" class="nav-link" data-scroll-target="#estimação-dos-k-parametros-na-rlm"><span class="header-section-number">9.3</span> Estimação dos k parametros na RLM</a>
  <ul class="collapse">
  <li><a href="#estimativas-de-mqo" id="toc-estimativas-de-mqo" class="nav-link" data-scroll-target="#estimativas-de-mqo"><span class="header-section-number">9.3.1</span> Estimativas de MQO</a></li>
  </ul></li>
  <li><a href="#qualidade-do-ajuste-na-regressão-linear-multipla" id="toc-qualidade-do-ajuste-na-regressão-linear-multipla" class="nav-link" data-scroll-target="#qualidade-do-ajuste-na-regressão-linear-multipla"><span class="header-section-number">9.4</span> Qualidade do Ajuste na Regressão Linear Multipla</a></li>
  <li><a href="#valor-espererado-dos-estimadores-de-mqo" id="toc-valor-espererado-dos-estimadores-de-mqo" class="nav-link" data-scroll-target="#valor-espererado-dos-estimadores-de-mqo"><span class="header-section-number">9.5</span> Valor Espererado dos Estimadores de MQO</a></li>
  <li><a href="#variância-dos-estimadores-de-mqo-1" id="toc-variância-dos-estimadores-de-mqo-1" class="nav-link" data-scroll-target="#variância-dos-estimadores-de-mqo-1"><span class="header-section-number">9.6</span> Variância dos Estimadores de MQO</a>
  <ul class="collapse">
  <li><a href="#eficiencia-de-mqo-o-teorema-de-gauss-markov" id="toc-eficiencia-de-mqo-o-teorema-de-gauss-markov" class="nav-link" data-scroll-target="#eficiencia-de-mqo-o-teorema-de-gauss-markov"><span class="header-section-number">9.6.1</span> Eficiencia de MQO: O Teorema de Gauss-Markov</a></li>
  </ul></li>
  <li><a href="#uso-de-variáveis-qualitativas-na-análise-de-rlm" id="toc-uso-de-variáveis-qualitativas-na-análise-de-rlm" class="nav-link" data-scroll-target="#uso-de-variáveis-qualitativas-na-análise-de-rlm"><span class="header-section-number">9.7</span> Uso de Variáveis Qualitativas na Análise de RLM</a>
  <ul class="collapse">
  <li><a href="#uma-única-variável-dummy-independente" id="toc-uma-única-variável-dummy-independente" class="nav-link" data-scroll-target="#uma-única-variável-dummy-independente"><span class="header-section-number">9.7.1</span> Uma única Variável Dummy Independente</a></li>
  <li><a href="#o-uso-de-dummies-para-categorias-multiplas." id="toc-o-uso-de-dummies-para-categorias-multiplas." class="nav-link" data-scroll-target="#o-uso-de-dummies-para-categorias-multiplas."><span class="header-section-number">9.7.2</span> O uso de Dummies para categorias multiplas.</a></li>
  <li><a href="#incorporando-informações-ordinais-com-o-uso-de-variáveis-dummy." id="toc-incorporando-informações-ordinais-com-o-uso-de-variáveis-dummy." class="nav-link" data-scroll-target="#incorporando-informações-ordinais-com-o-uso-de-variáveis-dummy."><span class="header-section-number">9.7.3</span> Incorporando Informações Ordinais com o uso de Variáveis Dummy.</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#teste-de-hipóteses-no-rlm" id="toc-teste-de-hipóteses-no-rlm" class="nav-link" data-scroll-target="#teste-de-hipóteses-no-rlm"><span class="header-section-number">10</span> Teste de Hipóteses no RLM</a>
  <ul class="collapse">
  <li><a href="#hipótese-de-normalidade" id="toc-hipótese-de-normalidade" class="nav-link" data-scroll-target="#hipótese-de-normalidade"><span class="header-section-number">10.1</span> Hipótese de Normalidade</a></li>
  <li><a href="#teste-de-hipótese-sob-um-único-parametro" id="toc-teste-de-hipótese-sob-um-único-parametro" class="nav-link" data-scroll-target="#teste-de-hipótese-sob-um-único-parametro"><span class="header-section-number">10.2</span> Teste de Hipótese sob um Único Parametro</a>
  <ul class="collapse">
  <li><a href="#teste-contra-hipoteses-alternativas-unilaterais" id="toc-teste-contra-hipoteses-alternativas-unilaterais" class="nav-link" data-scroll-target="#teste-contra-hipoteses-alternativas-unilaterais"><span class="header-section-number">10.2.1</span> Teste contra Hipoteses Alternativas Unilaterais</a></li>
  <li><a href="#teste-contra-hipoteses-alternativas-bilaterais" id="toc-teste-contra-hipoteses-alternativas-bilaterais" class="nav-link" data-scroll-target="#teste-contra-hipoteses-alternativas-bilaterais"><span class="header-section-number">10.2.2</span> Teste contra Hipoteses Alternativas Bilaterais</a></li>
  <li><a href="#cálculos-dos-p-valores-dos-testes-t" id="toc-cálculos-dos-p-valores-dos-testes-t" class="nav-link" data-scroll-target="#cálculos-dos-p-valores-dos-testes-t"><span class="header-section-number">10.2.3</span> Cálculos dos p-valores dos Testes t</a></li>
  <li><a href="#teste-de-restrições-de-lineares-múltiplas-o-teste-f" id="toc-teste-de-restrições-de-lineares-múltiplas-o-teste-f" class="nav-link" data-scroll-target="#teste-de-restrições-de-lineares-múltiplas-o-teste-f"><span class="header-section-number">10.2.4</span> Teste de Restrições de Lineares Múltiplas: O teste F</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#alguns-problemas-que-podem-surgir-na-análise-de-regressão-com-corte-transversa" id="toc-alguns-problemas-que-podem-surgir-na-análise-de-regressão-com-corte-transversa" class="nav-link" data-scroll-target="#alguns-problemas-que-podem-surgir-na-análise-de-regressão-com-corte-transversa"><span class="header-section-number">11</span> 5 - Alguns Problemas que podem surgir na Análise de Regressão com Corte Transversa</a>
  <ul class="collapse">
  <li><a href="#multicolinearidade-pefeita" id="toc-multicolinearidade-pefeita" class="nav-link" data-scroll-target="#multicolinearidade-pefeita"><span class="header-section-number">11.1</span> 5.1 - Multicolinearidade Pefeita</a></li>
  <li><a href="#heteroscedasticidade" id="toc-heteroscedasticidade" class="nav-link" data-scroll-target="#heteroscedasticidade"><span class="header-section-number">11.2</span> Heteroscedasticidade</a></li>
  <li><a href="#viés-de-variável-omitida-e-a-correlação-entre-as-variáveis-explicativas-e-o-termo-de-erro." id="toc-viés-de-variável-omitida-e-a-correlação-entre-as-variáveis-explicativas-e-o-termo-de-erro." class="nav-link" data-scroll-target="#viés-de-variável-omitida-e-a-correlação-entre-as-variáveis-explicativas-e-o-termo-de-erro."><span class="header-section-number">11.3</span> Viés de Variável Omitida e a Correlação entre as variáveis explicativas e o termo de Erro.</a></li>
  </ul></li>
  <li><a href="#modelos-com-variáveis-dependentes-qualitativasmodelo-de-probabilidade-linear-mpm-probit-e-logit." id="toc-modelos-com-variáveis-dependentes-qualitativasmodelo-de-probabilidade-linear-mpm-probit-e-logit." class="nav-link" data-scroll-target="#modelos-com-variáveis-dependentes-qualitativasmodelo-de-probabilidade-linear-mpm-probit-e-logit."><span class="header-section-number">12</span> Modelos com Variáveis Dependentes Qualitativas:Modelo de Probabilidade Linear (MPM), Probit e Logit.</a></li>
  <li><a href="#modelos-de-contagem-e-duração-regressão-de-poisson-e-modelo-de-sobrevivência-de-cox." id="toc-modelos-de-contagem-e-duração-regressão-de-poisson-e-modelo-de-sobrevivência-de-cox." class="nav-link" data-scroll-target="#modelos-de-contagem-e-duração-regressão-de-poisson-e-modelo-de-sobrevivência-de-cox."><span class="header-section-number">13</span> Modelos de Contagem e Duração: Regressão de Poisson e Modelo de Sobrevivência de Cox.</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Modelos Lineares</span></h1>
<p class="subtitle lead">Aplicação a Pesquisa em Direito</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!---- comentário é assim que faz ------->
<section id="regressão-linear-simples---rls" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Regressão Linear Simples - RLS</h1>
<p>Vamos iniciar o estudo de modelos lineares começando pela Regresão Linear Simples (RLS). Mais específicamente, vamos estudar a RLS no contexto de dados de corte transversal. Tal abordagem, segmentada por tipos de dados, facilíta o entendimento das hipóteses do modelo.</p>
<p>Entender como funciona o modelo RLS é a base para entender como funciona outras extensões desse tipo de modelo, tal como o modelo de regressão linear multipla (RLM), amplamente utilizado em trabalhos empíricos.</p>
<p>Os conceitos estatísticos aplicados no estudo de RLS são os mesmos apresentados na seção anterior.</p>
<p>O matérial desta seção é baseado na 4ed do livro de Jeffrey Wooldridge, Introdução à Econometria: Uma Abordagem Moderna, de 2013. Embora o título do livro remeta à econometria, os modelos apresentados no livro são aplicaveis à diversas Ciências Sociais, tais como o Direito, Ciência Política, Sociologia, Pscologia Empírica etc…</p>
<p>A análise de Regressão é um instrumento poderoso para os centistas sociais. Grosso modo, como veremos abaixo, ela nos permite simular, ao menos parcialmente, aplicações de caráter quase experimental. Podemos verificar como determinadas variáveis importantes nas ciencias sociais interagem com outras variáveis, as vezes em uma relação de causa e efeito.</p>
<section id="introdução" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="introdução"><span class="header-section-number">8.1</span> Introdução</h2>
<p>Considere o modelo abaixo</p>
<p><span class="math display">\[y = \beta_0 + \beta_1x + u \]</span> Nesta equação, <span class="math inline">\(y\)</span> é a variavel dependente ou também denominada de variável explicativa; <span class="math inline">\(x\)</span> é a variável explicativa e <span class="math inline">\(u\)</span> é o termo de erro. Essa equação é uma equação de <strong>regressão linear simples</strong>.</p>
<p>Considere um exemplo mais concreto de uma equação de regressão linear simples. Sumponha que gostariamos de explicar a taxa de crimes nos bairros de uma cidade, dado os níveis de desemprego na localidade. Nosso modelo de regressão poderia ser específicado da seguinte maneira:</p>
<p><span class="math display">\[crime_i = \beta_0 + \beta_1Desemprego_i + u\]</span> O subscrito <span class="math inline">\(i\)</span> se refere a um bairro hipotético da cidade. Note que nesse caso,<span class="math inline">\(i\)</span> é o subscrito que relaciona nossas unidades de observação (bairros). Nossas unidades de observação podem variar a depender do contexto em estudo: países, cidades, bairros, estados. No caso das aplicações em Jurimetria, por exemplo, podemos ter como unidade de observação varas onde tramitam os processos.</p>
<p>Note que, novamente o termo de erro, <span class="math inline">\(u\)</span>, está presente na equação. O termo de erro, não observado, capta tudo aquilo que afeta <span class="math inline">\(crime\)</span>, mas que não estamos controlando. Adiante faremos hipóteses sobre as características de <span class="math inline">\(u\)</span> que irão nos auxiliar na analise da RLS.</p>
<p>Voltemos a equação básica:</p>
<p><span class="math display">\[y = \beta_0 + \beta_1x + u \]</span></p>
<p>Na analise de RLS estamos interessados nos parametros <span class="math inline">\(\beta_0\)</span> e sobretudo <span class="math inline">\(\beta_1\)</span>. A razão primordial para isso é que, tudo o mais constante, a relação acima aponta que</p>
<p><span class="math display">\[\Delta y = \beta_1 \Delta x \]</span> , se <span class="math inline">\(\Delta u = 0\)</span></p>
<p>Isto é, se tudo o mais que afeta <span class="math inline">\(y\)</span> permanecer inalterado, uma variáção em <span class="math inline">\(x\)</span>, <span class="math inline">\(\Delta x\)</span>, terá um impacto de <span class="math inline">\(\beta_1 \Delta x\)</span> em <span class="math inline">\(y\)</span>. No exemplo da criminalidade, teremos que:</p>
<p><span class="math display">\[\Delta crime = \beta_1 \Delta desemprego \]</span></p>
<p>Por isso, quando conseguimos estimar os parêmetros <span class="math inline">\(\beta\)</span> estamos mais próximos de entender as relações entre <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> em nossas aplicações.</p>
<p>Cabe destacar algo bastante importante.As relações acima não encerram a questão da causalidade. Como podemos inferir um impacto causal do desemprego na criminalidade se estamos ignorando todos os demais fatores que ficaram de fora do modelo - fatores que são captados em <span class="math inline">\(u\)</span> não observados.</p>
<p>Para avançarmos no que diz respeito a firmações de carater causais, precisamos fazer hipoteses sobre o comportamento de <span class="math inline">\(u\)</span>. Com isso estaremos mais perto de inferir causalidade.</p>
<section id="alguns-exemplos-de-regressão-aplicados-ao-contexto-jurídico" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="alguns-exemplos-de-regressão-aplicados-ao-contexto-jurídico"><span class="header-section-number">8.1.1</span> Alguns Exemplos de Regressão Aplicados ao Contexto Jurídico:</h3>
<p>Considere os seguintes exemplos de RLS aplicadas ao contexto do Direito</p>
<p><strong>Previsão de Sentenças com Base na Gravidade do Crime:</strong> Onde, a variável dependente e a Duração da Sentença, e a variável independente é a Gravidade do Crime, <span class="math inline">\(\beta_0\)</span>é o intercepto da regressão. <span class="math inline">\(\beta_1\)</span> é o coeficiente de regressão que representa como a gravidade do crime influência a duração da sentença, <span class="math inline">\(u\)</span> é o termo de erro.</p>
<p><span class="math display">\[Dsent = \beta_0 + \beta_1{\text{Gravidade}} + u\]</span></p>
<p><strong>Análise de Fatores que Influenciam o Tempo de Julgamento:</strong> Variável Independente (<span class="math inline">\(x\)</span>), Tipo de Processo (por exemplo, criminal, civil, administrativo). Variável Dependente (<span class="math inline">\(y\)</span>, Tempo de Duração do Processo. Objetivo: Identificar se o tipo de processo tem impacto no tempo que um caso leva para ser concluído.</p>
<p><span class="math display">\[Tempo = \beta_0 + \beta_1  Processo  + u\]</span></p>
<p><strong>Previsão de Probabilidade de Recurso com Base em Decisões Anteriores:</strong> Variável Independente (<span class="math inline">\(x\)</span>): Resultado da Decisão Anterior (por exemplo, deferimento ou negação do recurso). Variável Dependente (<span class="math inline">\(y\)</span>): Probabilidade de Entrada com Recurso. Objetivo: Determinar a probabilidade de um recurso ser apresentado com base no resultado de decisões passadas.</p>
<p><span class="math display">\[Resultado = \beta_0 + \beta_1 Resultado_{-1} + u \]</span> <strong>Análise de Relação entre Número de Testemunhas e Veredito:</strong> Variável Independente (<span class="math inline">\(x\)</span>): Número de Testemunhas. Variável Dependente (<span class="math inline">\(y\)</span>): Veredito (por exemplo, culpado ou inocente). Objetivo: Investigar se o número de testemunhas influencia o veredito</p>
<p><span class="math display">\[ Veredito = \beta_0 + \beta_1 Testemunhas + u \]</span></p>
</section>
</section>
<section id="hipóteses-sobre-o-comportamento-do-termo-de-erro" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="hipóteses-sobre-o-comportamento-do-termo-de-erro"><span class="header-section-number">8.2</span> Hipóteses sobre o comportamento do Termo de Erro</h2>
<p>Se especificamos o modelo com <span class="math inline">\(\beta_0\)</span>, podemos assumir que <span class="math inline">\(u\)</span>, tem média igual a zero. Em notação de esperança matematica essa hipotese equivale a:</p>
<p><span class="math display">\[E(u) = 0\]</span> Note que, <span class="math inline">\(x\)</span> é <span class="math inline">\(u\)</span> são variaveis aleatórias, então então podemos definir a distribuição condicional de <span class="math inline">\(u\)</span> dado qualquer valor de <span class="math inline">\(x\)</span>. Especialmente, para qualquer valor de <span class="math inline">\(x\)</span> podemos obter o valor médio de <span class="math inline">\(u\)</span> para uma parte da populção com uma dado valor de <span class="math inline">\(x\)</span>.</p>
<p>Com base nisso, podemos definir uma segunda hipotese sobre <span class="math inline">\(u\)</span>. Uma hipótese bastante forte, é a de que <span class="math inline">\(u\)</span> e <span class="math inline">\(x\)</span> são independentes. Tal hípótese é a hipótese crucial do modelo de RLS:</p>
<p><span class="math display">\[E(u|x) = 0\]</span></p>
<p>Essa hipótese é denominada de hipótese de independência da média de <span class="math inline">\(x\)</span>.</p>
<p>Justas as hipóteses de <span class="math inline">\(E(u) = 0\)</span> e <span class="math inline">\(E(u|x) = 0\)</span> são denominadas de hipotese de média condicional zero.</p>
<p>Ao adcionarmos essas hipoteses em nosso arcabouço de estudo RLS, temos uma nova interpretação do parametro <span class="math inline">\(\beta_1\)</span> (focaremos mais neste parametro, visto que $ é em geral menos importante na maioria das aplicações de análise de regressão)</p>
<p>Considere o modelo baixo padrão</p>
<p><span class="math display">\[y = \beta_0 + \beta_1x + u\]</span> Aplicando o operador <span class="math inline">\(E( \cdot |x )\)</span>, obetmos</p>
<p><span class="math display">\[ E( y |x ) = \beta_0 + \beta_1x \]</span> Assim, na equação acima, temos um aumento de uma unidade em <span class="math inline">\(x\)</span>, implica em um aumento no valor esperado (ou em média) de <span class="math inline">\(y\)</span> na magnitude de <span class="math inline">\(\beta_1\)</span>.</p>
<p>Para todo <span class="math inline">\(x\)</span> a distribuição dos valores de <span class="math inline">\(y\)</span> estarão centratas ao redor da média condicional de <span class="math inline">\(y\)</span> dado <span class="math inline">\(x\)</span>, $ E( y |x )$. Lembre que a média é uma medida de tendencia central. Nesse sentido, a regressão linear simples calcula uma média condicional.</p>
<p>A equação acima, é caracterizada como <strong>função de regressão populacional</strong>. Essa função nos fornece a elação entre os diferentes níveis de<span class="math inline">\(x\)</span> é o nível médio de <span class="math inline">\(y\)</span>, isto é <span class="math inline">\(E( y |x )\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figuras\modelpop.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Função de Regressão Populacional</figcaption>
</figure>
</div>
<p>Agora, podemos voltar a nossa equação base e verificarmos o progresso feito no entendimento do modelo:</p>
<p><span class="math display">\[y = \beta_0 + \beta_1x + u \]</span> <span class="math display">\[y = E( y |x ) + u \]</span> Na equação acima, <span class="math inline">\(E( y |x )\)</span> é chamada de parte sistematica de <span class="math inline">\(y\)</span>. Isto é, a parte sistematicamente explicada por <span class="math inline">\(x\)</span>. Já o termo de erro não observado, <span class="math inline">\(u\)</span> é a parte não sistematica de <span class="math inline">\(y\)</span>, não explicada por <span class="math inline">\(x\)</span>.</p>
</section>
<section id="estimação-dos-parâmetros-da-rls" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="estimação-dos-parâmetros-da-rls"><span class="header-section-number">8.3</span> Estimação dos Parâmetros da RLS</h2>
<p>Não conhecemos <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> queremos estimadores desses parametros: <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span>.</p>
<p>Suponha que tenhamos uma amostra aleatória da população: <span class="math inline">\(\{(x_i, y_i): i = 1, ..., n\}\)</span></p>
<p>Em nosso modelo base:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1x_i + u_i \]</span></p>
<p>onde <span class="math inline">\(u_i\)</span> é o erro aleatório da <span class="math inline">\(i\)</span>-ésima observação.</p>
<p>Como estimamos <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>?</p>
<p>Utilizando as hipoteses <span class="math inline">\(E(u) = 0\)</span> e <span class="math inline">\(E(u|x) = 0\)</span>, podemos utilizar aplicar um estimador de metodos dos momentos.</p>
<p>Como <span class="math inline">\(x\)</span> e <span class="math inline">\(u\)</span> são não correlacionados (são independentes), a covariancia entre eles é 0, <span class="math inline">\(Cov(x,u) = 0\)</span>. Pode-se demostrar que</p>
<p><span class="math display">\[Cov(x,u) = E(ux) - E(u)E(x)\]</span></p>
<p>Mas como, por hipotese, <span class="math inline">\(E(u) = 0\)</span>, a equação anterior se reduz à</p>
<p><span class="math display">\[Cov(x,u) = E(ux)\]</span> Assim, como <span class="math inline">\(Cov(x,u)\)</span> é <span class="math inline">\(0\)</span>, temos também que</p>
<p><span class="math display">\[E(ux) = 0\]</span> Logo, temos que <span class="math display">\[E(u) = 0\]</span> e</p>
<p><span class="math display">\[E(xu)=0\]</span> Essas duas ultimas igualdades, são denominadas <strong>condições de momentos populacionais</strong>. Elas são hipóteses feitas na população.</p>
<p>Para aplicarmos o Método dos Momentos, precisamos igual as condições de momento populacionais as condições de momentos amostrais.</p>
<p>Antes, vamos reescrever as condições populacionais.</p>
<p>Como</p>
<p><span class="math display">\[y = \beta_0 + \beta_1x + u \]</span></p>
<p>Podemos isolar <span class="math inline">\(u\)</span> e obtermos</p>
<p><span class="math display">\[ u  =  y - \beta_0  - \beta_1x \]</span> Com isso podemos reescrever as hipoteses <span class="math inline">\(E(u) = 0\)</span> e <span class="math inline">\(E(ux) = 0\)</span> reespectivamente como</p>
<p><span class="math display">\[E( y - \beta_0  - \beta_1x) = 0\]</span></p>
<p><span class="math display">\[E(x( y - \beta_0  - \beta_1x)) = 0\]</span> Os equivalentes amostrais serão dados por:</p>
<p><span class="math display">\[n^{-1} \sum_{i=1}^{n} (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i)^2 = 0\]</span> e</p>
<p><span class="math display">\[ n^{-1} \sum_{i=1}^{n} x_i (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i)^2 = 0\]</span></p>
<p>As duas equações acima formam um sistema de 2 equações com 2 incognitas, <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>. Com algumas manipilações algébricas é possível demostrar que, os valores de dos parâmetros <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> serão dados por:</p>
<p><span class="math display">\[\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}\]</span></p>
<p>e</p>
<p><span class="math display">\[\hat{\beta}_1 = \frac{\sum_{i=1}^{n} (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^{n} (x_i - \bar{x})^2}\]</span></p>
<p>Onde, {x} e {y} são as médias amostrais de <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> respectivamente.</p>
<p>Os estimadores <span class="math inline">\(\hat{\beta}_0\)</span> e <span class="math inline">\(\hat{\beta}_1\)</span> são chamados de estimadores de Mínimos Quadrados Ordinários (MQO). Note que, entretanto, método de estimação para encontrarmos <span class="math inline">\(\hat{\beta}_0\)</span> e <span class="math inline">\(\hat{\beta}_1\)</span>. Na verdade, pode-se mostrar que as estimativas do modelo de RLS serão equivalentes pelos dois métodos, dadas as hipoteses enunciadas anteriormente.</p>
<p>A ideia é que os parametros que estimamos, <span class="math inline">\(\hat{\beta}_0\)</span> e <span class="math inline">\(\hat{\beta}_1\)</span>, são os parametros que minimizam a soma dos quadrados das diferenças entre nossos <span class="math inline">\(y_i\)</span> obversados e seus <strong>valores preditos</strong> definidos como</p>
<p><span class="math display">\[\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1x_i\]</span></p>
<p>O raciocinio é o seguinte. Vamos definir a distancia entre <span class="math inline">\(y_i\)</span> é <span class="math inline">\(\hat{y}_i\)</span>, denominada de <strong>resíduo da equação</strong> como</p>
<p><span class="math display">\[\hat{u_i} = \hat{y}- \hat{y}_i = y_i - \hat{\beta}_0 + \hat{\beta}_1x\]</span></p>
<p>Note que em uma amostra de tamanho <span class="math inline">\(n\)</span>, teremos <span class="math inline">\(n\)</span> desses resíduos. Esconlhendo os parametros <span class="math inline">\(\hat{\beta}_0\)</span> e <span class="math inline">\(\hat{\beta}_1\)</span> que minimizam a soma dos quadrados desses resíduos:</p>
<p><span class="math display">\[\sum_{i=1}^{n} \hat{u}_i^2 = \sum_{i=1}^{n} (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i)^2\]</span></p>
<p>Formalmente a soma dos quadrados dos resíduos é uma função de <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span>. Chamemos essa função de <span class="math inline">\(Q(\hat{\beta_0},\hat{\beta_1} )\)</span>:</p>
<p><span class="math display">\[Q(\hat{\beta_0},\hat{\beta_1} ) = \sum_{i=1}^{n} (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i)^2\]</span> Utilizando tecnicas de minimização do cálculo (foras do escopo deste curso), obteremos os valores de <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span>:</p>
<p><span class="math display">\[\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}\]</span></p>
<p>e</p>
<p><span class="math display">\[\hat{\beta}_1 = \frac{\sum_{i=1}^{n} (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^{n} (x_i - \bar{x})^2}\]</span> Tal qual obtidos anteriormente.</p>
<p>Independentemente do método escolido, conseguimos obter a <strong>Função de Regressão Amostral (FRA)</strong>, que é a versão estimada da <strong>Função de Regressão Populacional (FRP)</strong></p>
<p>A FRP é fixa e desconhecida, a FRA varia de amostra para amostra.</p>
<p>Formalmente, a FRA é dada por</p>
<p><span class="math display">\[\hat{y}= \hat{\beta}_0 + \hat{\beta}_1x\]</span></p>
<p>Como mencionado anteriormente, nosso interresse primordial reside em <span class="math inline">\(\hat{\beta}_1\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figuras\fittedvalue.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Valores Ajustados e Resíduos de MQO</figcaption>
</figure>
</div>
<p>Note que conforme já comentado:</p>
<p><span class="math display">\[\Delta \hat{y} = \hat{\beta}_1 \Delta x \]</span></p>
<p>Isolando <span class="math inline">\(\hat{\beta_1}\)</span></p>
<p><span class="math display">\[ \hat{\beta}_1  = \Delta \hat{y} /\Delta x \]</span></p>
<p>Assim, uma variáção, <span class="math inline">\(\Delta\)</span>, em <span class="math inline">\(x\)</span>, nos permimite calcular o impacto em <span class="math inline">\(y\)</span>, medido dado por <span class="math inline">\(\hat{\beta}_1\)</span>.</p>
<p>Antes de passarmos para o proxímo tópico de RLS, cabe mencionar uma nota sobre terminologia: quando estimamos equações de RLS do tipo <span class="math inline">\(y = \beta_0 + \beta_1 x + u\)</span>, dizemos que “<em>rodamos a regressão de</em> <span class="math inline">\(y\)</span> sobre <span class="math inline">\(x\)</span> !”</p>
<section id="aplicação---estimando-uma-regressão-linear-simples" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="aplicação---estimando-uma-regressão-linear-simples"><span class="header-section-number">8.3.1</span> Aplicação - Estimando uma Regressão Linear Simples</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Aplicação da RLS - Método dos Mínimos Quadrados Ordinários</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="caracteristicas-do-método-dos-mínimos-quadrados-ordinários-em-determinadas-amostras-de-dados" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="caracteristicas-do-método-dos-mínimos-quadrados-ordinários-em-determinadas-amostras-de-dados"><span class="header-section-number">8.4</span> Caracteristicas do Método dos Mínimos Quadrados Ordinários em Determinadas Amostras de Dados</h2>
<section id="valores-estimados-e-resíduos" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="valores-estimados-e-resíduos"><span class="header-section-number">8.4.1</span> Valores estimados e Resíduos</h3>
<p>Uma vez estimados <span class="math inline">\(\hat{\beta}_0\)</span> e <span class="math inline">\(\hat{\beta}_1\)</span> temos os valores ajustados ou também denominados de valores preditos ou <em>fitted values</em>.</p>
<p>Para uma observação qualquer <span class="math inline">\(i\)</span>, seu valor estimado é:</p>
<p><span class="math display">\[\hat{y}_i= \hat{\beta}_0 + \hat{\beta}_1x_i\]</span></p>
<p>De maneira geral teremos a reta de regressão, dada por:</p>
<p><span class="math display">\[\hat{y}= \hat{\beta}_0 + \hat{\beta}_1x\]</span></p>
<p>Todos os valores <span class="math inline">\(\hat{y}\)</span> estarão sobre a reta de regressão.</p>
<p>O resíduo, tal qual definido anteriormente, será a diferença entre o valor ajustado <span class="math inline">\(\hat{y}\)</span> e o verdadeiro <span class="math inline">\(y\)</span> em nosso banco de dados:</p>
<p><span class="math display">\[\hat{u}_i = y_i - \hat{y}_i\]</span></p>
<p>Se <span class="math inline">\(\hat{u_i} &gt; 0\)</span> a regressaõ subestima <span class="math inline">\(y_i\)</span>. Se <span class="math inline">\(\hat{u_i} &lt; 0\)</span> a reta superestima <span class="math inline">\(y_i\)</span>. O cenário ideal é quando <span class="math inline">\(\hat{u}_i= 0\)</span>, algo que quase nunca acontece.</p>
</section>
<section id="propriedades-algébricas-do-mqo" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="propriedades-algébricas-do-mqo"><span class="header-section-number">8.4.2</span> Propriedades Algébricas do MQO</h3>
<ol type="1">
<li>A Soma dos Resíduos é zero:</li>
</ol>
<p><span class="math display">\[\sum_{i=1}^{n} \hat{u}_i = 0\]</span></p>
<ol start="2" type="1">
<li>A covariancia amostral entre a variavel explicativa e os resíduos é zero:</li>
</ol>
<p><span class="math display">\[\sum_{i=1}^{n} x_i \hat{u}_i = 0\]</span></p>
<ol start="3" type="1">
<li><p>O ponto <span class="math inline">\((\bar{x},\bar{y})\)</span> sempre estará sob a reta de regressão.</p></li>
<li><p>A média dos valores estimados, <span class="math inline">\(\bar{\hat{y}}\)</span> é igual a média dos valores observados <span class="math inline">\(\bar{y}\)</span>.</p></li>
<li><p>Note que as estimatvas de MQO decompõe <span class="math inline">\(y\)</span> em 2 partes: 1) os valores ajustados <span class="math inline">\(\hat{y}\)</span> e os resíduos <span class="math inline">\(\hat{u}\)</span>.</p></li>
<li><p>Os valores de <span class="math inline">\(\hat{y}\)</span> e <span class="math inline">\(\hat{u}\)</span> são não correlacionados na amostra!</p></li>
</ol>
</section>
<section id="qualidade-do-ajuste" class="level3" data-number="8.4.3">
<h3 data-number="8.4.3" class="anchored" data-anchor-id="qualidade-do-ajuste"><span class="header-section-number">8.4.3</span> Qualidade do Ajuste</h3>
<p>Nesta seção vamos responder a seguinte questão: “<em>Quão bem</em> <span class="math inline">\(x\)</span> explica <span class="math inline">\(y\)</span> ?”</p>
<p>Considere as seguintes definições</p>
<p>Soma dos Quadrado Totais (SQT):</p>
<p><span class="math display">\[\text{SQT} = \sum_{i=1}^{n} (y_i - \bar{y})^2\]</span></p>
<p>Soma dos Quadrados Explicados (SQE):</p>
<p><span class="math display">\[\text{SQE} = \sum_{i=1}^{n} (\hat{y}_i - \bar{y})^2\]</span></p>
<p>Soma dos Quadrados dos Resíduos (SQR):</p>
<p><span class="math display">\[\text{SQR} = \sum_{i=1}^{n} \hat{u}_i^2\]</span> Temos alguns resultados bem importantes. Note que, ao dividirmos <span class="math inline">\(SQT\)</span> por <span class="math inline">\(n-1\)</span>, teremos a variancia amostral de <span class="math inline">\(y\)</span>. Por sua vez, ao dividirmos <span class="math inline">\(SQE\)</span> por <span class="math inline">\(n-1\)</span>, termeos a variancia populacional de <span class="math inline">\(\hat{y}\)</span>.</p>
<p>Entretanto, o resultado mais importante é o seguinte:</p>
<p><span class="math display">\[SQT =  SQE + SQR\]</span> É apartir dessa iguadade que podemos mostrar algo sobre o ajuste dos MQO.</p>
<p>Dívidindo ambos os lados por <span class="math inline">\(SQT\)</span> teremos</p>
<p><span class="math display">\[1 = \frac{\text{SQE}}{\text{SQT}}  + \frac{\text{SQR}}{\text{SQT}}\]</span> Rearranjando os termos</p>
<p><span class="math display">\[R^2 = \frac{\text{SQE}}{\text{SQT}} = 1 - \frac{\text{SQR}}{\text{SQT}}\]</span></p>
<p>O <span class="math inline">\(R^2\)</span> é a porcentagem da variação de y que é explicada por <span class="math inline">\(x\)</span>. O valor de <span class="math inline">\(R^2\)</span> sempre estará na RLS entre <span class="math inline">\(0\)</span> e <span class="math inline">\(1\)</span>.</p>
<p>O nome <span class="math inline">\(R^2\)</span> advém do fato de que, pode ser mostrado que tal médida é equivalente ao quadrado do coeficiente de correlação entre <span class="math inline">\(\hat{y}\)</span> e <span class="math inline">\(y\)</span>.</p>
</section>
</section>
<section id="ausência-de-viés-e-variância-dos-estimadores-de-mqo" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="ausência-de-viés-e-variância-dos-estimadores-de-mqo"><span class="header-section-number">8.5</span> Ausência de Viés e Variância dos Estimadores de MQO</h2>
<section id="ausencia-de-viés-em-mqo" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="ausencia-de-viés-em-mqo"><span class="header-section-number">8.5.1</span> Ausencia de Viés em MQO</h3>
<p>Um estimador não viésado (ou não tendêncioso) por definição, um estimador que em média “acerta” o verdadeiro valor do parâmetro estimado.</p>
<p>Considere um estimador arbitrario <span class="math inline">\(\hat{\theta}\)</span>. Quando dezemos que <span class="math inline">\(\hat{\theta}\)</span> é não viesado, queremos dizer que</p>
<p><span class="math display">\[E(\hat{\theta}) = \theta\]</span></p>
<p>Será que os <span class="math inline">\(\hat{\beta}_0\)</span> e <span class="math inline">\(\hat{\beta}_1\)</span> estimados pelo método do MQO são não viésados?</p>
<p>Para responder a essa pergunta precisamos, mais uma vez, recorrer a novas hipoteses sobre os dados. Esse novo conjunto de hipoteses irão nos permitir verificarmos algumas <strong>propriedades estatísticas do método de MQO</strong>. A depender das hipóteses, umas mais fracas que outras, as propriedades podem mudar.</p>
<p>A garantia da ausência de viés, em dados de corte transversal, requer quatro hipóteses:</p>
<p><strong>1) Linearidade dos Parametros</strong>: No modelo Populacional a variavel dependente <span class="math inline">\(y\)</span> está relacionada a variável dependente <span class="math inline">\(x\)</span> e ao termo de erro <span class="math inline">\(u\)</span> como:</p>
<p><span class="math display">\[y = \beta_0 + \beta_1x + u \]</span> Por exemplo no modelo <span class="math inline">\(y= \beta_0 + e^{\beta_1} + u\)</span>, não é linear no parametro <span class="math inline">\(\beta_1\)</span>.</p>
<p><strong>2) Amostragem Aleatória:</strong> Usamos uma amostra aleatória de tamanho <span class="math inline">\(n\)</span>, <span class="math inline">\(\{(x_i, y_i): i = 1, 2, ..., n\}\)</span> proveniente de um modelo populacional.</p>
<p><strong>3) Existe Variação Amostral em</strong> <span class="math inline">\(x\)</span>: Isto é, os valores de nossa variável explicativa não são todos iguais.</p>
<p><strong>4) Independencia da Média:</strong> O termo de erro <span class="math inline">\(u\)</span> tem um valor esperado de zero, dado qualquer valor da variável explicativa.<span class="math display">\[E(u|x) = 0\]</span></p>
<p>Dadas as hipóteses 1, 2, 3 e 4:</p>
<p><span class="math display">\[E(\hat{\beta_1}) = \beta_1\]</span></p>
<p>e</p>
<p><span class="math display">\[E(\hat{\beta_0}) = \beta_0\]</span></p>
<p>Portantos nossoa estimadores de MQO, são não viésados.</p>
</section>
<section id="variância-dos-estimadores-de-mqo" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2" class="anchored" data-anchor-id="variância-dos-estimadores-de-mqo"><span class="header-section-number">8.5.2</span> Variância dos estimadores de MQO</h3>
<p>Quão distantes em média <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span> estão dos verdadeiros parâmetros? Saber disso nos permite escolher o melhor estimador entre todos os etimadores não viesados - ou ao menos entre uma ampla classe deles.</p>
<p>Para obetermos expressões tratáveis das variâncias do MQO recorremos a mais uma hipótese.</p>
<p><strong>5) Hipótese de Homoscedasticidade:</strong> O erro <span class="math inline">\(u\)</span> tem a mesma variâcia, dado qualquer valor da variável explicativa. Isto é,</p>
<p><span class="math display">\[Var(u|x)=\sigma^2\]</span></p>
<p>A variância de <span class="math inline">\(u\)</span> pode ser reescrita em termos de esperança:</p>
<p><span class="math display">\[Var(u|x)= \sigma^2 = E(u^2|x) - [E(u|x)]^2\]</span></p>
<p>Mas como temos por hipótese que <span class="math inline">\([E(u|x)]=0\)</span>, a hipótese de homoscedasticidade as vezes é representada como</p>
<p><span class="math display">\[ E(u^2|x) = \sigma^2\]</span></p>
<p>Note também, que como <span class="math inline">\(E(u)=0\)</span>, a variancia do erro, não condicional a <span class="math inline">\(x\)</span>, será dada por:</p>
<p><span class="math display">\[\sigma^2=E(u^2)=Var(u)\]</span> Por isso chamamos <span class="math inline">\(\sigma^2\)</span> de <strong>variância do erro</strong>.</p>
<p>Podemos “vizualizar” a hipótese de homoscedasticidade na figura abaixo:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figuras\homoscedastic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Modelo de Regressão Sob Homoscedasticidade</figcaption>
</figure>
</div>
<p>Apartir das hiopóteses 1,2,3,4 e 5 podemos progredir no entendimento dos MQO. Sob as hipoteses 1 - 5, as variancias de <span class="math inline">\(\hat{\beta_1}\)</span> e <span class="math inline">\(\hat{\beta_0}\)</span> são dadas por:</p>
<p><span class="math display">\[\text{Var}(\hat{\beta}_1) = \frac{\sigma^2}{\sum_{i=1}^{n} (x_i - \bar{x})^2}=\frac{\sigma^2}{\text{SST}_x}\]</span> e</p>
<p><span class="math display">\[\text{Var}(\hat{\beta}_0) = \frac{\sigma^2n^{-1}\sum_{i=1}^{n} x_i^2}{\sum_{i=1}^{n} (x_i - \bar{x})^2}\]</span></p>
<p>Uma extenção da variância dos estimadores de MQO são seus desvios padrão definidos simplismente pela raiz quadrada da variância:</p>
<p><span class="math display">\[ep(\hat{\beta}_0) = \sqrt{Var(\hat{\beta_0})}\]</span></p>
<p>e</p>
<p><span class="math display">\[ep(\hat{\beta}_1) = \sqrt{Var(\hat{\beta_1})} = \frac{\sigma}{\sqrt{SQT_x}}\]</span></p>
</section>
<section id="estimação-da-variância-do-erro" class="level3" data-number="8.5.3">
<h3 data-number="8.5.3" class="anchored" data-anchor-id="estimação-da-variância-do-erro"><span class="header-section-number">8.5.3</span> Estimação da Variância do erro</h3>
<p>Note que, nas formulas das variâncias e dos desvios-padrão, o que aparece explicitamente é o parâmetro populacional, <span class="math inline">\(\sigma^2\)</span> e <span class="math inline">\(\sigma\)</span>. Raramente conhecemos esses valores, logo as formulas derivadas acima terão pouca utilidade. Não obstante, caso encontremos um estimador para <span class="math inline">\(\sigma^2\)</span> e <span class="math inline">\(\sigma\)</span> podemos usar esse estimador.</p>
<p>Podemos utilizar os resíduos para construir um estimador da variância dos erros. Lembre que o resíduos da <span class="math inline">\(i\)</span>-ésima observação do modelo é dado por:</p>
<p><span class="math display">\[\hat{u_i} = y_i - \hat{y_i}\]</span> Pode-se demostrar que, um estimador não viesado de <span class="math inline">\(\sigma^2\)</span> será dado por:</p>
<p><span class="math display">\[\hat{\sigma}^2=\frac{\sum_{i=1}^{n} \hat{u}_i^2}{n-2} = \frac{\text{SQR}}{n-2}\]</span></p>
<p>Com <span class="math inline">\(\hat{\sigma}^2\)</span> em mãos, podemos reescrever os erros padrão dos estimadores de MQO:</p>
<p><span class="math display">\[ep(\hat{\beta}_1) = \sqrt{Var(\hat{\beta_1})} = \frac{\hat{\sigma}^2}{\sqrt{SQT_x}}\]</span></p>
<p>Os erros padrão são utilizados para calcularmos as estatísticas de teste e Intervalos de Confiança para as Estimativas. Mais a frente iremos nos concentar nessas questões.</p>
</section>
</section>
<section id="aplicação-de-rls---foco-no-erro-padrão-do-parametro-b1" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="aplicação-de-rls---foco-no-erro-padrão-do-parametro-b1"><span class="header-section-number">8.6</span> Aplicação de RLS - Foco no erro padrão do parametro b1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Aplicação do de RLS - Foco no erro padrão</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="regressão-linear-múltipla-rlm" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Regressão Linear Múltipla (RLM)</h1>
<p>A RLM é uma extensão natural da RLS. Entretanto, ao invés de termos apenas uma variável explicativa podemos ter <span class="math inline">\(k\)</span> variáveis dependentes</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \ldots + \beta_k x_k + u\]</span> A hípótese fundamental é a de que:</p>
<p><span class="math display">\[E(u|x_1, . . . ,x_k) = 0\]</span></p>
<p>Qualquer problema que faça qualquer um dos <span class="math inline">\(x_1, ...., x_k\)</span> ser correlacionado com <span class="math inline">\(u\)</span> invalida a hipótese acima. Tal hipótese implica em não viés do MQO.</p>
<section id="exemplos-de-regressão-multipla-no-contexto-jurídico" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="exemplos-de-regressão-multipla-no-contexto-jurídico"><span class="header-section-number">9.1</span> Exemplos de Regressão Multipla no Contexto Jurídico</h2>
<p><strong>Determinação de Fatores que Afetam o Valor de Indenizações:</strong> Variáveis Independentes: Idade da Vítima, Gravidade do Dano, Jurisdição. Variável Dependente: Valor da Indenização.Objetivo: Analisar como a idade da vítima, a gravidade do dano e a jurisdição influenciam o valor das indenizações concedidas</p>
<p><span class="math display">\[Indenização = \beta_0 + \beta_1 idade+ \beta_2 Gravidade + \beta_2 Jurisdisção + u\]</span></p>
<p><strong>Análise de Variáveis que Influenciam Taxas de Condenação em Casos Criminais:</strong> Variáveis Independentes: Idade do Réu, Tipo de Crime, Local do Julgamento. Variável Dependente: Taxa de Condenação.Objetivo: Investigar como a idade do réu, o tipo de crime e o local do julgamento afetam a probabilidade de condenação.</p>
<p><span class="math display">\[Tx.Condenação = \beta_0 + \beta_1  idade  +  \beta_2 Local  + \beta_3  crime + u\]</span></p>
<p><strong>nálise de Fatores que Influenciam a Taxa de Feminicídio:</strong> Variáveis Independentes (X): Taxa de Desemprego, Índice de Educação, Presença de Políticas de Proteção à Mulher. Variável Dependente (Y): Taxa de Feminicídio por 100.000 mulheres. Objetivo: Investigar como o desemprego, o nível de educação e a existência de políticas de proteção à mulher estão relacionados à taxa de feminicídio em diferentes regiões.</p>
<p><span class="math display">\[Tx.feminicidio = \beta_0 + \beta_1 desemprego + \beta_2 educ + \beta_3 política + u \]</span></p>
</section>
<section id="a-interpretação-da-equação-de-regressão-de-mqo" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="a-interpretação-da-equação-de-regressão-de-mqo"><span class="header-section-number">9.2</span> A Interpretação da Equação de Regressão de MQO</h2>
<p>Tal qual no modelo de RLS, temos que:</p>
<p><span class="math display">\[\Delta y = \beta_1 \Delta x_1 + \beta_2 \Delta x_2 + ...+\beta_k \Delta x_k\]</span></p>
<p>O coefiente <span class="math inline">\(\beta_j\)</span>, com <span class="math inline">\(j=1,...k\)</span>, mede o efeito do incremento de uma unidade de <span class="math inline">\(x_j\)</span> em <span class="math inline">\(y\)</span>.</p>
<p>Suponha que estejamos interessados no impacto de <span class="math inline">\(x_1\)</span>. Podemos fazer o seguinte exercício: Tudo o mais constante qual o impacto de <span class="math inline">\(x_1\)</span> em <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[\frac{\Delta y}{\Delta x} = \beta_1  \]</span></p>
<p>Manter outros fatores fixos permite o cientista social, “mimetizar” um experimento, tal qual nas Ciências Naturasi. Obviamente, isso não tão simples assim. Entretanto, mater outros fatores fixos, e supondo que <span class="math display">\[E(u|x_1, . . . ,x_k) = 0\]</span> , nos aproxíma de afirmações de cunho causal.</p>
</section>
<section id="estimação-dos-k-parametros-na-rlm" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="estimação-dos-k-parametros-na-rlm"><span class="header-section-number">9.3</span> Estimação dos k parametros na RLM</h2>
<section id="estimativas-de-mqo" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="estimativas-de-mqo"><span class="header-section-number">9.3.1</span> Estimativas de MQO</h3>
<p>A mecânica para conseguirmos estimativas de <span class="math inline">\(\beta_j\)</span>, fica uma pouco mais complicada. Felizmente, os <em>softwares</em>, tais como o <em>R</em>, fornecem essas estimativas com muita facilidade. Não obstante, convêm apresentar uma abordagem para o calculo desses parâmetros. Utilizaremos álgebra de matrizes para mostrar um “algoritmo” para calcular esses <span class="math inline">\(\beta_j\)</span>. Em verdade, esse é o algoritmo utilizado pela função <code>lm()</code> do <em>R</em> no computo dos estimadores.</p>
<p>Considere o modelo para a <span class="math inline">\(i\)</span>-ésima observação</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_{i1} + \beta_{i2} x_2 + \beta_{i3} x_3 + \ldots + \beta_k x_{ik} + u\]</span></p>
<p>como temos <span class="math inline">\(n\)</span> observações (tamanho de nossa amostra), podemos organizar esses valores em vetores e matrizes.</p>
<p>Para os valores de <span class="math inline">\(y\)</span> teremos</p>
<p><span class="math display">\[
\mathbf{y} = \begin{bmatrix}
y_1 \\
y_2 \\
\vdots \\
y_n
\end{bmatrix}
\]</span></p>
<p>Os valores das variáves independentes <span class="math inline">\(X\)</span> podem ser organizados da seguinte maneira:</p>
<p><span class="math display">\[\mathbf{X} = \begin{bmatrix}
1 &amp; x_{11} &amp; \cdots &amp; x_{1k} \\
1 &amp; x_{21} &amp; \cdots &amp; x_{2k} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; x_{n1} &amp; \cdots &amp; x_{nk}
\end{bmatrix}\]</span></p>
<p>Os <span class="math inline">\(\beta_j\)</span> são organizados da seguinte maneira:</p>
<p><span class="math display">\[\boldsymbol{\beta} = \begin{bmatrix}
\beta_0 \\
\beta_1 \\
\beta_2 \\
\vdots \\
\beta_p
\end{bmatrix}\]</span></p>
<p>Os erros <span class="math inline">\(u_i\)</span> serão armazenados da em um vetor coluna tambêm:</p>
<p><span class="math display">\[\mathbf{u} = \begin{bmatrix}
u_1 \\
u_2 \\
\vdots \\
u_n
\end{bmatrix}\]</span></p>
<p>Apartir disso representamos o modelo de RLM da seguinte maneira:</p>
<p><span class="math display">\[\mathbf{y} = \mathbf{X} \boldsymbol{\beta} + \mathbf{u}\]</span></p>
<p>Queremos encontrar um estimador de <span class="math inline">\(\boldsymbol{\beta}\)</span>, que chamaremos de <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span>. Esse estimador sera dado por:</p>
<p><span class="math display">\[\hat{\boldsymbol{\beta}} = (\mathbf{X}^T \mathbf{X})^{-1} \mathbf{X}^T \mathbf{y}\]</span></p>
<p>Onde <span class="math inline">\(\mathbf{X}^T\)</span> é a matriz transposta de <span class="math inline">\(\mathbf{X}\)</span>, e <span class="math inline">\((\mathbf{X}^T \mathbf{X})^{-1}\)</span> é a matriz inversa da seguinte multiplicação de matrizes, <span class="math inline">\((\mathbf{X}^T \mathbf{X})\)</span></p>
<p>Esse vetor de estimativas irá nos fornecer os valores para os <span class="math inline">\(\beta_j\)</span>,com <span class="math inline">\(j=1,...,k\)</span>. Assim temos que:</p>
<p><span class="math display">\[ \hat{\boldsymbol{\beta}} = \begin{bmatrix}
\hat{\beta}_0 \\
\hat{\beta}_1 \\
\hat{\beta}_2 \\
\vdots \\
\hat{\beta}_k
\end{bmatrix}\]</span></p>
<p>Antes, de prosseguirmos cabe destacar que, embora não precisamos saber as formulas explicitas para dos <span class="math inline">\(\hat{\beta_j}\)</span>, as vezes isso nos ajuda a entender o funcionamento da regressão multipla e os efeitos parciais que os <span class="math inline">\(\beta_j\)</span> exercem sobre <span class="math inline">\(y\)</span>.</p>
<p>Por exemplo, <span class="math inline">\(\hat{\beta_1}\)</span> pode ser representado da seguinte maneira no contexto da RLM:</p>
<p><span class="math display">\[\hat{\beta}_1 = \frac{\sum_{i=1}^n \hat{r_{i1}} y_i}{\sum_{i=1}^n \hat{r_{i1}}^2}\]</span></p>
<p>Onde <span class="math inline">\(r_{i1}\)</span> são os resíduos da regressão de <span class="math inline">\(x_1\)</span> sobre todas as demais variáveis do modelo <span class="math inline">\(x_2,...,x_k\)</span>. Nesse caso, podemos entender que $_1 $ mede o efeito de <span class="math inline">\(x_1\)</span> sobre <span class="math inline">\(y\)</span> após terem sido <em>parcializados</em> ou <em>descontados</em> os impactos de <span class="math inline">\(x_2,...,x_k\)</span>.</p>
<p>Para um <span class="math inline">\(\beta_j\)</span> qualquer a interpretação é análoga.</p>
<p><span class="math display">\[\hat{\beta}_j = \frac{\sum_{i=1}^n \hat{r_{ij}} y_i}{\sum_{i=1}^n \hat{r_{ij}}^2}\]</span></p>
</section>
</section>
<section id="qualidade-do-ajuste-na-regressão-linear-multipla" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="qualidade-do-ajuste-na-regressão-linear-multipla"><span class="header-section-number">9.4</span> Qualidade do Ajuste na Regressão Linear Multipla</h2>
<p>Tal qual na regressão linear simples, são válidas as seguintes relações:</p>
<p>Soma dos Quadrado Totais (SQT):</p>
<p><span class="math display">\[\text{SQT} = \sum_{i=1}^{n} (y_i - \bar{y})^2\]</span></p>
<p>Soma dos Quadrados Explicados (SQE):</p>
<p><span class="math display">\[\text{SQE} = \sum_{i=1}^{n} (\hat{y}_i - \bar{y})^2\]</span></p>
<p>Soma dos Quadrados dos Resíduos (SQR):</p>
<p><span class="math display">\[\text{SQR} = \sum_{i=1}^{n} \hat{u}_i^2\]</span> Novamente podemos definir a qualidade do ajuste, medido pelo <span class="math inline">\(R^2\)</span>, como sendo igual à</p>
<p><span class="math display">\[R^2 = \frac{\text{SQE}}{\text{SQT}} = 1 - \frac{\text{SQR}}{\text{SQT}}\]</span></p>
<p>Explicitamente podemos escrever o <span class="math inline">\(R^2\)</span> tal como:</p>
<p><span class="math display">\[R^2 =  \frac{[\sum_{i=1}^n (y_i - \bar{y}) ( \hat{y}_i - \bar{\hat{y}} )]^2}{[\sum_{i=1}^n (y_i - \bar{y})^2][\sum_{i=1}^n(\hat{y}-\bar{\hat{y}})^2]}\]</span></p>
<p>Um fato importante sobre <span class="math inline">\(R^2\)</span> é que ele nunca diminui ao incluirmos variáveis no modelo. Isso decorre de propriedades algébricas desse indicador.Por isso, os softwares geralmente reportam uma outra estatística de ajuste o R-quadrado ajustado,<span class="math inline">\(\bar{R}^2\)</span>:</p>
<p><span class="math display">\[\bar{R}^2 = 1 - \frac{(1 - R^2)(n - 1)}{n - k - 1}\]</span> O <span class="math inline">\(\bar{R}^2\)</span>, tal como expresso acima conta com a presença do <span class="math inline">\(R^2\)</span> original, mas note que, no denominador estamos dividindo por <span class="math inline">\(n-k-1\)</span>, onde <span class="math inline">\(n\)</span> é o tamanho da amostra em mãos, e <span class="math inline">\(k-1\)</span> se referem ao fato de termos <span class="math inline">\(k\)</span> variáveis explicativas e uma constante. Portanto, o <span class="math inline">\(\bar{R}^2\)</span>, impões uma penalidade à inclusão de variáveis independentes em um modelo de regressão.</p>
<p>Cabe destacar que, diferente do <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\bar{R}^2\)</span> pode ser negativo, indicando um ajuste bastante pobre do modelo.</p>
<p>Não obstante, cabe destacar que um <span class="math inline">\(R^2\)</span> baixo não é definitivamente uma evidencia definitiva contra nosso modelo. Em ciências sociais em geral é bastante comum verificarmos <span class="math inline">\(R^2\)</span> relatvamente pequenos. Isso significa que, embora coletovamente as variáveis explicativas não expliquem muito das variações de <span class="math inline">\(y\)</span>, é possível que as estimativas de MQO sejam estimativas confiaveis dos efeitos parciais - tudo o mais constante - de cada <span class="math inline">\(x_j\)</span> sobre <span class="math inline">\(y\)</span>.</p>
</section>
<section id="valor-espererado-dos-estimadores-de-mqo" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="valor-espererado-dos-estimadores-de-mqo"><span class="header-section-number">9.5</span> Valor Espererado dos Estimadores de MQO</h2>
<p>Quando analisamos a ausencia de viés nos estimadores do modelo de RLS, um invocamos um conjunto de hipóteses. Felizmente, na nalises de RLM tais hipoteses se mantém, bastando apenas algumas modificações para o contexto de mais variáveis explicativas. Abaixo vamos enunciar essas hipoteses que garantem o não viés dos <span class="math inline">\(\beta_j\)</span> estimados.</p>
<p><strong>1) Linearidade dos Parametros</strong>: No modelo Populacional a variavel dependente <span class="math inline">\(y\)</span> está relacionada as variáveis independentes e ao termo de erro <span class="math inline">\(u\)</span> como:</p>
<p><span class="math display">\[y = \beta_0 + \beta_1x_1 + ...+\beta_kx_k+u \]</span></p>
<p><strong>2) Amostragem Aleatória:</strong> Usamos uma amostra aleatória de tamanho <span class="math inline">\(n\)</span>, <span class="math inline">\(\{(x_{i1},...,x_{ik}, y_i): i = 1, 2, ..., n\}\)</span> proveniente de um modelo populacional.</p>
<p><strong>3) Colinearidade não Perfeita:</strong> Na amostra, e portanto na população, nehuma das variáveis explicativas são constantes e não há relações lineares extas entre as variáveis.Isto é, tais variáveis não são perfeitamente correlacionadas.</p>
<p>***4) Independencia da Média:** O termo de erro <span class="math inline">\(u\)</span> tem um valor esperado de zero, dado qualquer valor da variável explicativa.</p>
<p><span class="math display">\[E(u|x_1,...,x_k) = 0\]</span></p>
<p>Essa é a propriedade mais importante. Tal hipótese é violada quando a forma funciinal das variáveis explicativas e da variável dependente está incorreta ou mal especificada.</p>
<p>Qundo a hipótese se mantém, dizemos que as variáveis explicativas são exógenas.</p>
<p>Dadas as hipóteses 1, 2, 3 e 4:</p>
<p><span class="math display">\[E(\hat{\beta_j}) = \beta_j\]</span> Para <span class="math inline">\(j = 1,2,...,k\)</span>. Isto é, <span class="math inline">\(\hat{\beta_j}\)</span> são não viesados</p>
</section>
<section id="variância-dos-estimadores-de-mqo-1" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="variância-dos-estimadores-de-mqo-1"><span class="header-section-number">9.6</span> Variância dos Estimadores de MQO</h2>
<p>Analogamente ao que foi feito no caso da regressão simples, para obtermos a variância dos <span class="math inline">\(\hat{\beta_j}\)</span> de MQO presisamos recorrer à mais uma hipótese. Tal hipótese é a de homoscedasticidade. Isto é, de que condicionadas as variáveis explicativas, a variância do termo de erro é constante para todas as observações.</p>
<p><strong>5) Hipótese de Homoscedasticidade:</strong> O erro <span class="math inline">\(u\)</span> tem a mesma variâcia, dado qualquer valor das variáveis explicativas:</p>
<p><span class="math display">\[Var(u|x_1,...,x_k)=\sigma^2\]</span></p>
<p>Sob as hipóteses 1,2,3,4 e 5, a varincias de <span class="math inline">\(\hat{\beta_j}\)</span> e dada por:</p>
<p><span class="math display">\[\text{Var}(\hat{\beta}_j) = \frac{\hat{\sigma}^2}{\sum_{i=1}^{n} (x_{ij} - \bar{x_j})^2(1-R^2_j)}=\frac{\hat\sigma^2}{\text{SQT}_j(1-R^2_j)}\]</span> Onde <span class="math inline">\(SQT_j\)</span> é a a variação amostral de <span class="math inline">\(x_j\)</span>e <span class="math inline">\(R^2_j\)</span> é o R-quadrado da regressão de <span class="math inline">\(x_j\)</span> sobre as outras variáveis explicativas.O termo <span class="math inline">\(\hat{\sigma}^2\)</span> é o estimador da variâcia do termo de erro <span class="math inline">\(u\)</span>, dado por:</p>
<p><span class="math display">\[\hat{\sigma}^2=\frac{\sum_{i=1}^{n} \hat{u}_i^2}{n-k-1} = \frac{\text{SQR}}{n-k-1}\]</span> Onde <span class="math inline">\(n-k-1\)</span> são os graus de liberdade do problema de MQO: <span class="math inline">\(k\)</span> variáveis e uma constantante.</p>
<section id="eficiencia-de-mqo-o-teorema-de-gauss-markov" class="level3" data-number="9.6.1">
<h3 data-number="9.6.1" class="anchored" data-anchor-id="eficiencia-de-mqo-o-teorema-de-gauss-markov"><span class="header-section-number">9.6.1</span> Eficiencia de MQO: O Teorema de Gauss-Markov</h3>
<p><strong>Teorema de Gauss-Markov:</strong>Sob as hipóteses 1,2,3,4 e 5 os estimadores <span class="math inline">\(\hat{\beta}_0,\hat{\beta}_1,...,\hat{\beta}_k\)</span> são os melhores estimadores lineares não viesados de <span class="math inline">\(\beta_1, \beta_2,...,\beta_k\)</span>.</p>
<p>Se alguma das hipóteses falhar, o teorema não é mais válido.</p>
<p>É o teorema de Gauss-Markov que justifica o uso do MQO para estimar modelos de Regressão Linear Múltipla.</p>
</section>
</section>
<section id="uso-de-variáveis-qualitativas-na-análise-de-rlm" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="uso-de-variáveis-qualitativas-na-análise-de-rlm"><span class="header-section-number">9.7</span> Uso de Variáveis Qualitativas na Análise de RLM</h2>
<p>Considere os exemplos mencionados anteriormente.</p>
<p><strong>Determinação de Fatores que Afetam o Valor de Indenizações:</strong> Variáveis Independentes: Idade da Vítima, Gravidade do Dano, Jurisdição. Variável Dependente: Valor da Indenização.Objetivo: Analisar como a idade da vítima, a gravidade do dano e a jurisdição influenciam o valor das indenizações concedidas</p>
<p><span class="math display">\[Indenização = \beta_0 + \beta_1 idade+ \beta_2 Gravidade + \beta_2 Jurisdisção + u\]</span></p>
<p><strong>Análise de Variáveis que Influenciam Taxas de Condenação em Casos Criminais:</strong> Variáveis Independentes: Idade do Réu, Tipo de Crime, Local do Julgamento. Variável Dependente: Taxa de Condenação.Objetivo: Investigar como a idade do réu, o tipo de crime e o local do julgamento afetam a probabilidade de condenação.</p>
<p><span class="math display">\[Tx.Condenação = \beta_0 + \beta_1  idade  +  \beta_2 Local  + \beta_3  crime + u\]</span></p>
<p><strong>nálise de Fatores que Influenciam a Taxa de Feminicídio:</strong> Variáveis Independentes (X): Taxa de Desemprego, Índice de Educação, Presença de Políticas de Proteção à Mulher. Variável Dependente (Y): Taxa de Feminicídio por 100.000 mulheres. Objetivo: Investigar como o desemprego, o nível de educação e a existência de políticas de proteção à mulher estão relacionados à taxa de feminicídio em diferentes regiões.</p>
<p><span class="math display">\[Tx.feminicidio = \beta_0 + \beta_1 desemprego + \beta_2 educ + \beta_3 política + u \]</span></p>
<p>Em todos esses exemplos temos o denominamos de <strong>variáveis qualitativas</strong>. No primeiro exemplo, gravidade e jurisdição não são quantificaveis. No segundo exemplo, o tipo de crime, e a localidade também não. Por fim, no último exemplo, a variável que indica ou não a presença de uma política pública de proteção a mulher também é qualitativa.</p>
<p>Felizmente, isso não traz problemas adcionais a estimação de MQO. Pelo menos quando tais variáveis aparecem como variáveis explicativas. Mais a frente veremos o que acontece quando a variável dependente é do tipo qualitativa.</p>
<p>Duas coisas mudam quando temos as variáveis qualitativas como regressores. Em primeiro lugar temos que organizar essas informações no banco de dados de modo coerente. Em sugundo lugar, a introdução de variáveis qualitativas muda a interpretação dos resultados.</p>
<p>Fatores qualitativos geralmente aparecem na forma de informações binários, também denominadas,<em>dummy</em>.</p>
<p>Variável Binária ou Dummy: É uma variável que assume o valor 1 se a “condição occorre” e 0 caso o contrario.</p>
<p>Exemplos: O crime de feminicio ocorreu na região central? se sim, ela recebe o valor 1, se não recebe o valor 0. Podemos ter uma coluna em nosso banco de dados denominada centro, nas quais a linha recebe o valor 1 caso o crime tenha ocorrido, por exemplo, no centro e 0 caso o contrário.</p>
<p>O crime foi considerado grave? Se sim, recebe o valor 1 se não recebe o valor 0.</p>
<p>Suponha que queiramos investigar descriminação de gênero no mercado de trabalho. Se tivermos uma base de dados com informçoes sobre diversos individuos como anos de estudo, experiencia no mercado de trabalho. Podemos ter também uma variavel binaria que assume o valor 1 caso o individuo na amostra for do sexo feminino ou 0 caso o contrario.</p>
<p>O mesmo pode acontecer com etnia. Podemos ter uma dummy que assuma o valor 1, caso o individuo seja autodeclarado não-branco e 0, caso o contrario.</p>
<p>As observações que tiveram 1 como valor serão comparadas com aquelas observações que ficaram com o valor 0. Essas observações seriam nosso “grupo de comparação/grupo base”.</p>
<p>Trabalhar com variáveis qualitativas é muito comum. Na maioria das vezes cabe ao pesquisador o julgamento de trabalhar com uma variável desse tipo.</p>
<p>Utilizae 1 ou 0 é, de fato, um criterio arbitrario. Todavia, essa escolha reside justamente na vantagem de se capturar informações importantes que tornam a interpretação dos resultados mais simples.</p>
<section id="uma-única-variável-dummy-independente" class="level3" data-number="9.7.1">
<h3 data-number="9.7.1" class="anchored" data-anchor-id="uma-única-variável-dummy-independente"><span class="header-section-number">9.7.1</span> Uma única Variável Dummy Independente</h3>
<p>A forma mais simples de incorporar uma variável qualitativa e simplismente adcionarmos ela na equação de regressão.</p>
<p>Considere o exemplo prático. Queremos relacionar anos de estudo e salários. Obviamente, o exemplo é bastante simples, mas será útil para avaliarmos a questão.</p>
<p><span class="math display">\[salario = \beta_0 + \delta_0 feminino + \beta_1 educ + \beta_3 experiencia + u \]</span> Nesse exemplo, estamos controlando educação e experiência. A variável feminino assume o valor 1, se o individuo for do sexo feminino e 0, caso o contrário, isto é, o indivíduo é um homem. Na equação <span class="math inline">\(\delta_0\)</span> mede a diferença no salario entre homems e mulheres, dado os mesmos anos de estudos e de experiencia, e evidentemente o mesmo <span class="math inline">\(u\)</span>.</p>
<p>Assim, um indicio de discriminação de genero no mercado de trabalho, seria se encontracemos uma relação do tipo <span class="math inline">\(\delta_0 &lt; 0\)</span>.</p>
<p>Isso deveria ser interpretado como a diferença da média condicional aos níveis de educação e experiencia, entre homens e mulheres.</p>
<p>O uso de variáveis dummy pode ser interessante no contexto da análise de políticas públicas.</p>
<p>Considere que tenhamos uma base de dados municipal com uma serie dados sobre crimes contra as mulheres. Suponha hipoteticamente que alguns bairros dessa cidade hipotética tenham alguma iniciativa ou política pública local de combate e prevenção desses crimes. Em um primeiro momento suponha que queremos avaliar se nesses bairros a taxa de crimes contra as mulheres é menor. Considere que temos dados sobre o nível educacional médio da população do bairro, a taxa de desemprego nesses bairros, e uma variável que assume o valor 1 se no bairro em questão existe alguma política pública como a mencionada.</p>
<p>Considere a equação:</p>
<p><span class="math display">\[Tx.feminicidio = \beta_0 + \beta_1 desemprego + \beta_2 educ + \beta_3 política + u \]</span> Nesse exemplo, se estimarmos um <span class="math inline">\(\beta_3 &lt; 0\)</span> teriamos evidências de que em bairros onde há a política pública em questão, a taxa de crimes contra as mulheres é menor. Claramente, estamos supondo que todas as hipoteses mencinadas anteriormente são validadas, de modo que temos estimadores não viesados. Se existir alguma variável omitida em <span class="math inline">\(u\)</span> ou correlação entre <span class="math inline">\(u\)</span> e as variáveis explicativas, sobretudo entre <span class="math inline">\(u\)</span> e nossa dummy de interesse, teremos um estimador viésado de <span class="math inline">\(\beta_3\)</span> e provavelmente dos demais coeficientes.</p>
</section>
<section id="o-uso-de-dummies-para-categorias-multiplas." class="level3" data-number="9.7.2">
<h3 data-number="9.7.2" class="anchored" data-anchor-id="o-uso-de-dummies-para-categorias-multiplas."><span class="header-section-number">9.7.2</span> O uso de Dummies para categorias multiplas.</h3>
<p>Considere a equação abaixo</p>
<p><span class="math display">\[Tx.Condenação = \beta_0 + \beta_1  idade  +  \beta_2 Local  + \beta_3  crime + u\]</span> Suponha que nossas unidades de observação sejam indivíduos na cidade de São Paulo. Suponha que o local, seja o local do crime e represente as cinco zonas da cidade de São Paulo. Da forma como esta na regressão teriamos de escolher apenas uma Zona para avaliar (assumindo o valor 1), e as demais seriam as categorias bases. Pode ser interessante, caso nosso interresse resida na região em questão. Não obstante, podemos avaliar mais categorias.</p>
<p>Temos 5 zonas na cidade de São Paulo. Nesse caso, precisamos utilizar uma delas como grupo base. Supoha que tal zona seja o Centro. Nosso modelo fica da seguinte maneira</p>
<p><span class="math display">\[Tx.Condenação = \beta_0 + \beta_1  idade  +  \beta_2 Leste+  \beta_3 Sul +  \beta_4 Oeste   + \beta_5 Norte + \beta_6  crime + u\]</span></p>
<p>O mesmo deve ocorrer no tipo de crime. Suponha que por algum motivo razoavel classificamos os crimes em 3 categorias 1, 2 e 3, e queremos utilizar a categoria 2 como grupo base. Nesse caso, apenas rodamos a regressão com os crimes do tipo 1 e 2 :</p>
<p><span class="math display">\[Tx.Condenação = \beta_0 + \beta_1  idade  +  \beta_2 Leste+  \beta_3 Sul +  \beta_3 Oeste   + \beta_5 Norte + \beta_6  crime1 + \beta_7  crime3 u\]</span></p>
<p>O coeficiente estimado de <span class="math inline">\(\beta_3\)</span>, por exemplo, captaria a diferença média da taxa de condenação entre crimes que ocorrem na região Sul e o Centro da cidade de São Paulo, controlado para o mesmo tipo de crime e idade do indivíduo. Ja o coeficiente <span class="math inline">\(\beta_6\)</span> mediria a diferença de media entre a taxa de condenação para crimes do 1 e crimes do tipo 2, controlados pela localidade e idade do indivíduo.</p>
</section>
<section id="incorporando-informações-ordinais-com-o-uso-de-variáveis-dummy." class="level3" data-number="9.7.3">
<h3 data-number="9.7.3" class="anchored" data-anchor-id="incorporando-informações-ordinais-com-o-uso-de-variáveis-dummy."><span class="header-section-number">9.7.3</span> Incorporando Informações Ordinais com o uso de Variáveis Dummy.</h3>
<p><strong>Determinação de Fatores que Afetam o Valor de Indenizações:</strong> Variáveis Independentes: Idade da Vítima e Gravidade do Dano . Variável Dependente: Valor da Indenização.Objetivo: Analisar como a idade da vítima, a gravidade do dano influenciam o valor das indenizações concedidas.</p>
<p><span class="math display">\[Indenização = \beta_0 + \beta_1 idade+ \beta_2 Gravidade  + u\]</span> Suponha que a gravidade varie em uma escala de 0 a 4. Uma posibilidade seria estimar a equação acima, tal qual específicada.</p>
<p>Infelizmente, seria muito dificil interpretar um aumento de uma unidade na gravidade. Uma vez que a gravidade de um crime é medida de maneira ordinal. Por exemplo uma Gravidade de um crime classificada como 4 é maior que a Gravidade de um crime classificada como 3.</p>
<p>Utilizando o que já aprendemos, podemos utilizar a categoria de gravidade=0 (não grave) como base de comparação. Nesse caso estimariamos a seguinte regressão:</p>
<p><span class="math display">\[Indenização = \beta_0 + \beta_1 idade+ \beta_2 Grav1  ++ \beta_3 Grav2  ++ \beta_4 Grav3  ++ \beta_5 Grav4 + u\]</span> onde <span class="math inline">\(\beta_2\)</span> por exemplo, capta a diferença na indenização de uma crime de gravidade 1 em comparação de um crime com gravidade igual a 0.</p>
</section>
</section>
</section>
<section id="teste-de-hipóteses-no-rlm" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Teste de Hipóteses no RLM</h1>
<section id="hipótese-de-normalidade" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="hipótese-de-normalidade"><span class="header-section-number">10.1</span> Hipótese de Normalidade</h2>
</section>
<section id="teste-de-hipótese-sob-um-único-parametro" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="teste-de-hipótese-sob-um-único-parametro"><span class="header-section-number">10.2</span> Teste de Hipótese sob um Único Parametro</h2>
<section id="teste-contra-hipoteses-alternativas-unilaterais" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="teste-contra-hipoteses-alternativas-unilaterais"><span class="header-section-number">10.2.1</span> Teste contra Hipoteses Alternativas Unilaterais</h3>
</section>
<section id="teste-contra-hipoteses-alternativas-bilaterais" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="teste-contra-hipoteses-alternativas-bilaterais"><span class="header-section-number">10.2.2</span> Teste contra Hipoteses Alternativas Bilaterais</h3>
</section>
<section id="cálculos-dos-p-valores-dos-testes-t" class="level3" data-number="10.2.3">
<h3 data-number="10.2.3" class="anchored" data-anchor-id="cálculos-dos-p-valores-dos-testes-t"><span class="header-section-number">10.2.3</span> Cálculos dos p-valores dos Testes t</h3>
</section>
<section id="teste-de-restrições-de-lineares-múltiplas-o-teste-f" class="level3" data-number="10.2.4">
<h3 data-number="10.2.4" class="anchored" data-anchor-id="teste-de-restrições-de-lineares-múltiplas-o-teste-f"><span class="header-section-number">10.2.4</span> Teste de Restrições de Lineares Múltiplas: O teste F</h3>
</section>
</section>
</section>
<section id="alguns-problemas-que-podem-surgir-na-análise-de-regressão-com-corte-transversa" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> 5 - Alguns Problemas que podem surgir na Análise de Regressão com Corte Transversa</h1>
<section id="multicolinearidade-pefeita" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="multicolinearidade-pefeita"><span class="header-section-number">11.1</span> 5.1 - Multicolinearidade Pefeita</h2>
<p>A multicolinearidade é uma violação da hipótese 3. Nesse caso as variáveis ou alguma das variáveis podem ser escritas como uma combinação linear das demais. Esse é um caso extremo e que, no limite, não aparece com frequência nas aplicaçoes empíricas. Não obstante, uma multicolinearidade alta pode aparecer. Na presença de Multicolinearidade, nossos estimadores continuam sendo não viésados. Entretanto, a variância de <span class="math inline">\(\hat{\beta_j}\)</span> pode ficar muito elevada, prejudicando os procedimentos de inferência.</p>
<p>Podemos ver isso ao avaliarmos a formula da variância de uma dado <span class="math inline">\(\hat{\beta_j}\)</span> estimado:</p>
<p><span class="math display">\[\text{Var}(\hat{\beta}_j) = \frac{\hat{\sigma}^2}{\sum_{i=1}^{n} (x_{ij} - \bar{x_j})^2(1-R^2_j)}=\frac{\hat\sigma^2}{\text{SQT}_j(1-R^2_j)}\]</span></p>
<p>Note que, se a relação linear entre os <span class="math inline">\(x_1,...,x_k\)</span> forem elevadas, o <span class="math inline">\(R^2_j\)</span> será alto. No limite, um <span class="math inline">\(R^2_j\)</span> proximo de faz o denominador da divisão acima ficar muito pequeno. Com um denominador pequeno a <span class="math inline">\(\text{Var}(\hat{\beta}_j)\)</span> fica muito alta. No caso em que há multicolinearidade perfeita, o <span class="math inline">\(R^2_j =1\)</span>. logo, a <span class="math inline">\(Var(\hat{\beta_j})\)</span> não estará nem mesmo definida (haverá um divisão por zero!).</p>
<p>Na prática o problema da multicolinearidade não é uma unanimidade entre os autores. Muitos livros textos dedicam capítulos interios para tratar do problema, ao passo que outros autores a enxergam como uma mal menor.</p>
<p>A razão de se enchergar a multicolinearidade como uma mal menor é o fato de que ao olharmos novamente para o denominador da variância de <span class="math inline">\(\beta_j\)</span>, veremos que a variância de <span class="math inline">\(\hat{\beta_j}\)</span> pode diminuir ao aumentarmos a Soma dos Quadrados dos Totais de <span class="math inline">\(x_j\)</span>, <span class="math inline">\(SQT_j\)</span>. Isso pode ser feito aumentando o tamanho da amostra, e por conseguinte a variabilidade dos valores de <span class="math inline">\(x_j\)</span>. Por isso alguns autores se referem de maneira satírica ao problema da multicolinearidade como o problema da <strong>micronumerosidade</strong>. A razão disso é que, muitas vezes, nossa variância é alta porque nossa amostra é muito pequena.</p>
</section>
<section id="heteroscedasticidade" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="heteroscedasticidade"><span class="header-section-number">11.2</span> Heteroscedasticidade</h2>
<p>A heteroscedasticidade é a violação da hipótese de homoscedasticidade. Nesse caso, a variância do termo de erro <span class="math inline">\(u\)</span> deixa de ser constante. Logo cada observação passa a ter sua própria variância.</p>
<p>Não entraremos nos detalhes técnicos de como resolver o problema. Felizmente, a heterocesdasticidade pode ser detectada e corrigida sem grandes problemas.</p>
<p>A heteroscedasticidade, embora não interfira no viés das estimativas de MQO, interfere na variância. Quando ela esta presente nossos estimadores de MQO não serão mais eficientes. Isto é, MQO deixa de ter variância mínima. Com isso os erros padrão reportados pelo software estátistico serão problemáticos e todo nosso procedimento de inferência poderá estar comprometido.</p>
<p>Uma saída é computar erros-padrão robustos para nossos estimadores. Tais erros padrão robustos à heteroscedasticidade são maiores que os erros padrão convencionais. Não obstante, podemos nos resguardar do problema da heteroscedasticidade.</p>
<p>Vamos verificar isso com um exemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Aplicação: Erros Padrão Robustos à Heteroscedasticidade</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para detectar formalmente a heteroscedasticidade, podemos utilizar os seguintes testes: teste de Breusch-Pagan (BP) e o Teste de White.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">####Teste de Breusch-Pagan para Heteroscedasticidade</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="do">#####Teste de White para a detecção de Heteroscedasticidade</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="viés-de-variável-omitida-e-a-correlação-entre-as-variáveis-explicativas-e-o-termo-de-erro." class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="viés-de-variável-omitida-e-a-correlação-entre-as-variáveis-explicativas-e-o-termo-de-erro."><span class="header-section-number">11.3</span> Viés de Variável Omitida e a Correlação entre as variáveis explicativas e o termo de Erro.</h2>
</section>
</section>
<section id="modelos-com-variáveis-dependentes-qualitativasmodelo-de-probabilidade-linear-mpm-probit-e-logit." class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Modelos com Variáveis Dependentes Qualitativas:Modelo de Probabilidade Linear (MPM), Probit e Logit.</h1>
</section>
<section id="modelos-de-contagem-e-duração-regressão-de-poisson-e-modelo-de-sobrevivência-de-cox." class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Modelos de Contagem e Duração: Regressão de Poisson e Modelo de Sobrevivência de Cox.</h1>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./descritiva.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Análise Descritiva</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./outrosmodelos.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Outros Modelos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>