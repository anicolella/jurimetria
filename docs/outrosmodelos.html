<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alexandre Nicolella e Felipe Bauer">
<meta name="dcterms.date" content="2024-03-12">

<title>9&nbsp; Modelos Avançados – Jurimetria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lineares.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Jurimetria</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./outrosmodelos.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Modelos Avançados</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prefácio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Sumário do Curso ESMP</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipulacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Maipulando os Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./googledrive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Google Drive</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">O Dplyr</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descritiva_v2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Análise Descritiva</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estatistica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Uma Introdução à Estatística</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lineares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelos Lineares</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./outrosmodelos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Modelos Avançados</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#modelos-com-variáveis-dependentes-qualitativas" id="toc-modelos-com-variáveis-dependentes-qualitativas" class="nav-link active" data-scroll-target="#modelos-com-variáveis-dependentes-qualitativas"><span class="header-section-number">9.1</span> Modelos com Variáveis Dependentes Qualitativas</a>
  <ul class="collapse">
  <li><a href="#variáveis-dependentes-binárias" id="toc-variáveis-dependentes-binárias" class="nav-link" data-scroll-target="#variáveis-dependentes-binárias"><span class="header-section-number">9.1.1</span> Variáveis Dependentes Binárias</a></li>
  <li><a href="#o-modelo-de-probabilidade-linear" id="toc-o-modelo-de-probabilidade-linear" class="nav-link" data-scroll-target="#o-modelo-de-probabilidade-linear"><span class="header-section-number">9.1.2</span> O Modelo de Probabilidade Linear</a></li>
  <li><a href="#modelo-de-regressão-logistica-logit" id="toc-modelo-de-regressão-logistica-logit" class="nav-link" data-scroll-target="#modelo-de-regressão-logistica-logit"><span class="header-section-number">9.1.3</span> Modelo de Regressão Logistica: Logit</a></li>
  </ul></li>
  <li><a href="#dados-de-contagem-modelo-de-regressão-de-poisson" id="toc-dados-de-contagem-modelo-de-regressão-de-poisson" class="nav-link" data-scroll-target="#dados-de-contagem-modelo-de-regressão-de-poisson"><span class="header-section-number">9.2</span> Dados de Contagem: Modelo de Regressão de Poisson</a>
  <ul class="collapse">
  <li><a href="#exemplo" id="toc-exemplo" class="nav-link" data-scroll-target="#exemplo"><span class="header-section-number">9.2.1</span> Exemplo:</a></li>
  </ul></li>
  <li><a href="#modelo-com-dados-em-painel-modelos-de-efeitos-fixos" id="toc-modelo-com-dados-em-painel-modelos-de-efeitos-fixos" class="nav-link" data-scroll-target="#modelo-com-dados-em-painel-modelos-de-efeitos-fixos"><span class="header-section-number">9.3</span> Modelo com Dados em Painel: Modelos de Efeitos Fixos</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Modelos Avançados</span></h1>
<p class="subtitle lead">Aplicação à Pesquisa em Direito</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alexandre Nicolella e Felipe Bauer </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 12, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="modelos-com-variáveis-dependentes-qualitativas" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="modelos-com-variáveis-dependentes-qualitativas"><span class="header-section-number">9.1</span> Modelos com Variáveis Dependentes Qualitativas</h2>
<section id="variáveis-dependentes-binárias" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="variáveis-dependentes-binárias"><span class="header-section-number">9.1.1</span> Variáveis Dependentes Binárias</h3>
<p><strong>Exemplos de resultados binários:</strong></p>
<ol type="1">
<li>Um consumidor compra ou não compra um produto.</li>
<li>Um juiz acata ou não um determinado pedido.</li>
<li>Um indíviduo decide ou não se vai procurar emprego.</li>
<li>Um homicídio feminino é classificado como feminicídio ou não.</li>
</ol>
<p><strong>Variável dependente binária</strong>:</p>
<p>A variável de resultado será, <span class="math inline">\(y = 1\)</span>, se o evento de interesse ocorre, caso o contrario <span class="math inline">\(y=0\)</span>. Os modelos de Variáveis Dependentes Limitadas são bastante difundidos nas análises empíricas nas ciências sociais.</p>
</section>
<section id="o-modelo-de-probabilidade-linear" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="o-modelo-de-probabilidade-linear"><span class="header-section-number">9.1.2</span> O Modelo de Probabilidade Linear</h3>
<p>O modelo será especificado como:</p>
<p><span class="math display">\[y= \beta_0 + \beta_1 x_1 + ... +\beta_kx_k +u\]</span></p>
<p>O modelo acima estima a <strong>probabilidade do evento de interesse ocorrer</strong> dado as variáveis explicativas. Em notação matemática pode ser representado da seguinte maneira:</p>
<p><span class="math display">\[p=Pr(Y=1)=F(\mathbf{x}'\boldsymbol{\beta})\]</span></p>
<p>No modelo de probabilidade linear:</p>
<p><span class="math display">\[p=Pr(Y=1)=F(\mathbf{x}'\boldsymbol{\beta})= \beta_0 + \beta_1 x_1 + ... +\beta_kx_k \]</span></p>
<p>Os coeficientes <span class="math inline">\(\beta_j\)</span> estimados indicam o impacto na probabilidade de <span class="math inline">\(Y=1\)</span>. No modelo MPL a estimação dos coeficientes são feitas de maneira análoga ao modelo de RLM.</p>
<p><strong>Vejamos um exemplo:</strong></p>
<ul>
<li>Estudamos a probabilidade de uma mulher estar no mercado de trabalho <span class="math inline">\(P(inlf=1)\)</span></li>
</ul>
<p><span class="math display">\[P(\text{inlf}=1)= \beta_0 + \beta_1 \text{nwifeinc} + \beta_2 \text{edu} +\beta_3 \text{exp}+\]</span> <span class="math display">\[\beta_4 \text{exp}^2+\beta_5 \text{age}+\beta_6 \text{kidslt6}+\beta_7 \text{kidsge6} +\epsilon\]</span></p>
<ul>
<li>Dependendo da renda familiar adicional (nwifeinc), da educação (educ), da experiência (exper e exper^2), da sua idade (age), do número de crianças menores de 6 anos (kidslt6) e do número de crianças maiores do que 6 anos (kidsge6).</li>
</ul>
<p>O Script abaixo estima um modelo de probabilidade linear usando o conjunto de dados <code>mroz.dta</code>, da mesma forma que fizemos anteriormente (usando o <code>lm</code>). Vejamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(wooldridge)){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"wooldridge"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(wooldridge)}</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mroz, <span class="at">package=</span><span class="st">"wooldridge"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate linear probability model</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>linprob <span class="ot">&lt;-</span> <span class="fu">lm</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6 ,<span class="at">data=</span>mroz)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linprob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = inlf ~ nwifeinc + educ + exper + I(exper^2) + age + 
    kidslt6 + kidsge6, data = mroz)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.93432 -0.37526  0.08833  0.34404  0.99417 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.5855192  0.1541780   3.798 0.000158 ***
nwifeinc    -0.0034052  0.0014485  -2.351 0.018991 *  
educ         0.0379953  0.0073760   5.151 3.32e-07 ***
exper        0.0394924  0.0056727   6.962 7.38e-12 ***
I(exper^2)  -0.0005963  0.0001848  -3.227 0.001306 ** 
age         -0.0160908  0.0024847  -6.476 1.71e-10 ***
kidslt6     -0.2618105  0.0335058  -7.814 1.89e-14 ***
kidsge6      0.0130122  0.0131960   0.986 0.324415    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4271 on 745 degrees of freedom
Multiple R-squared:  0.2642,    Adjusted R-squared:  0.2573 
F-statistic: 38.22 on 7 and 745 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Interpretação</strong></p>
<p>O coeficiente estimado da educação (educ) pode ser interpretado como: um ano adicional de escolaridade aumenta a probabilidade de uma mulher estar na força de trabalho, tudo o mais constante, em 0,038, em média.</p>
<p><strong>O Problema</strong></p>
<p>Um problema com o MPL é que <span class="math inline">\(P(y = 1|x)\)</span> é especificado como uma função linear dos regressores. Por construção, existem combinações (mais ou menos realistas) de valores de regressores que produzem <span class="math inline">\(\hat{y} &lt; 0\)</span> ou <span class="math inline">\(\hat{y}&gt;0\)</span>. Como são probabilidades, isso realmente não faz sentido.</p>
<p>Veja que os valores previstos para duas mulheres:</p>
<ul>
<li><strong>MULHER 1</strong>: renda familiar adicional de 50 mil ano, 7 anos de escolaridade, não tem experiência, com 25 anos e possui 2 filhos menores de 6 anos. A probabilidade de estar na força de trabalho estimada é -24%….não faz sentido.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Podemos calcular assim a probabilidade </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5855192</span> <span class="sc">-</span> <span class="fl">0.0034052</span><span class="sc">*</span><span class="dv">50</span>  <span class="sc">+</span> <span class="fl">0.0379953</span><span class="sc">*</span><span class="dv">7</span>  <span class="sc">+</span> <span class="fl">0.0394924</span><span class="sc">*</span><span class="dv">0</span>  <span class="sc">-</span><span class="fl">0.0005963</span><span class="sc">*</span><span class="dv">0</span>  <span class="sc">-</span> <span class="fl">0.0160908</span><span class="sc">*</span><span class="dv">25</span>  <span class="sc">-</span><span class="fl">0.2618105</span><span class="sc">*</span><span class="dv">2</span>  <span class="sc">+</span> <span class="fl">0.0130122</span><span class="sc">*</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2446647</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou assim: </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>xpred <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">nwifeinc=</span><span class="fu">c</span>(<span class="dv">50</span>),<span class="at">educ=</span><span class="fu">c</span>(<span class="dv">7</span>),<span class="at">exper=</span><span class="fu">c</span>(<span class="dv">0</span>), <span class="st">"I(exper^2)"</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a> <span class="at">age=</span><span class="fu">c</span>(<span class="dv">25</span>),<span class="at">kidslt6=</span><span class="fu">c</span>(<span class="dv">2</span>),<span class="at">kidsge6=</span><span class="fu">c</span>(<span class="dv">0</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linprob,xpred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1 
-0.2446632 </code></pre>
</div>
</div>
<ul>
<li><strong>MULHER 2</strong>: Não tem renda adicional, 17 anos de escolaridade, 30 anos de experiência, com 52 anos e não possui filhos. A probabilidade de estar na força de trabalho estimada é 104%….não faz sentido. Veja os cálculos abaixo:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Podemos calcular assim a probabilidade </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5855192</span> <span class="sc">-</span> <span class="fl">0.0034052</span><span class="sc">*</span><span class="dv">0</span>  <span class="sc">+</span> <span class="fl">0.0379953</span><span class="sc">*</span><span class="dv">17</span>  <span class="sc">+</span> <span class="fl">0.0394924</span><span class="sc">*</span><span class="dv">30</span>  <span class="sc">-</span><span class="fl">0.0005963</span><span class="sc">*</span><span class="dv">900</span>  <span class="sc">-</span> <span class="fl">0.0160908</span><span class="sc">*</span><span class="dv">52</span>  <span class="sc">-</span><span class="fl">0.2618105</span><span class="sc">*</span><span class="dv">0</span>  <span class="sc">+</span> <span class="fl">0.0130122</span><span class="sc">*</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.04282</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou assim</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>xpred1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">nwifeinc=</span><span class="fu">c</span>(<span class="dv">0</span>),<span class="at">educ=</span><span class="fu">c</span>(<span class="dv">17</span>), <span class="at">exper=</span><span class="fu">c</span>(<span class="dv">30</span>), <span class="st">"I(exper^2)"</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">30</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a> <span class="at">age=</span><span class="fu">c</span>(<span class="dv">52</span>),<span class="at">kidslt6=</span><span class="fu">c</span>(<span class="dv">0</span>),<span class="at">kidsge6=</span><span class="fu">c</span>(<span class="dv">0</span>))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(linprob,xpred1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
1.042808 </code></pre>
</div>
</div>
</section>
<section id="modelo-de-regressão-logistica-logit" class="level3" data-number="9.1.3">
<h3 data-number="9.1.3" class="anchored" data-anchor-id="modelo-de-regressão-logistica-logit"><span class="header-section-number">9.1.3</span> Modelo de Regressão Logistica: Logit</h3>
<p>No modelo Logit a função linear é substituida pela função de distribuição acumulada logistica:</p>
<p><span class="math display">\[ Pr(Y_i=1)=F(\mathbf{x}'\boldsymbol{\beta})=\text{Logit}^{-1}(\mathbf{x}'\boldsymbol{\beta})\]</span></p>
<p>Ou</p>
<p><span class="math display">\[\text{Logit}^{-1}(\mathbf{x}'\boldsymbol{\beta}) = \frac{\exp(\mathbf{x}'\boldsymbol{\beta})}{1 + \exp(\mathbf{x}'\boldsymbol{\beta})}
\ \]</span></p>
<p>Assumindo que:</p>
<p><span class="math display">\[log \left( \frac{P_t}{1-P_t}\right)=\mathbf{X}`\beta\]</span></p>
<p>Resolvendo para <span class="math inline">\(P_t\)</span>, tem-se que:</p>
<p><span class="math display">\[ Pr(Y_i=1)=F(\mathbf{x}'\boldsymbol{\beta}) = \frac{\exp(\mathbf{x}'\boldsymbol{\beta})}{1 + \exp(\mathbf{x}'\boldsymbol{\beta})}\]</span></p>
<p>Portanto, o resultado do modelo logístico fornece o efeito da variação de uma unidade em <span class="math inline">\(X\)</span> no log da razão de chances entre as probabilidades <span class="math inline">\(Y=1\)</span> e <span class="math inline">\(Y=0\)</span>. Infelizmente a interpretação direta não nos traz uma leitura significativa do que está acontecendo nessa população.</p>
<p>Duas maneiras para analisarmos o resultados são:</p>
<p><strong>Razão de Chance</strong></p>
<p>A <strong>razão de chances</strong> ou <strong>risco relativo</strong>, <span class="math inline">\(p/(1-p)\)</span>, mede a probabilidade de <span class="math inline">\(y=1\)</span> em relação à probabilidade de <span class="math inline">\(y=0\)</span>.</p>
<p>Uma razão de chances de 2 significa que o resultado <span class="math inline">\(y=1\)</span> (de ganhar uma aposta, por exemplo) é duas vezes mais provável que o resultado de <span class="math inline">\(y=0\)</span> (de perder uma aposta).</p>
<p>A razão de chances é dada por:</p>
<p><span class="math display">\[\frac{p}{1 - p} = \exp(\mathbf{x}' \boldsymbol{\beta})\]</span></p>
<p><strong>Efeito Marginal:</strong></p>
<p>Outra maneira é encontrar o efeito marginal do estimador, que irá fornecer a seguinte interpretação, um aumento em <span class="math inline">\(X\)</span> aumenta(diminui) em <span class="math inline">\(\beta\)</span> pontos percentuais a probabilidade de ser <span class="math inline">\(Y=1\)</span>. Vejamos os exemplos abaixo para ficar um pouco mais claro.</p>
<section id="exemplo-e-interpretação" class="level4" data-number="9.1.3.1">
<h4 data-number="9.1.3.1" class="anchored" data-anchor-id="exemplo-e-interpretação"><span class="header-section-number">9.1.3.1</span> Exemplo e interpretação</h4>
<p>Primeiramente vamos estimar o modelo logit. Usamos a mesma base que indica se a mulher está na força de trabalho <span class="math inline">\((Y=1)\)</span> ou se a mulher está fora da força de trabalho <span class="math inline">\((Y=0)\)</span>, variável <em>inlf</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mroz, <span class="at">package=</span><span class="st">"wooldridge"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Modelo logit, familia da binomial = logit</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6 , <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>), <span class="at">data=</span>mroz)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = inlf ~ nwifeinc + educ + exper + I(exper^2) + age + 
    kidslt6 + kidsge6, family = binomial(link = "logit"), data = mroz)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.425452   0.860365   0.495  0.62095    
nwifeinc    -0.021345   0.008421  -2.535  0.01126 *  
educ         0.221170   0.043439   5.091 3.55e-07 ***
exper        0.205870   0.032057   6.422 1.34e-10 ***
I(exper^2)  -0.003154   0.001016  -3.104  0.00191 ** 
age         -0.088024   0.014573  -6.040 1.54e-09 ***
kidslt6     -1.443354   0.203583  -7.090 1.34e-12 ***
kidsge6      0.060112   0.074789   0.804  0.42154    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1029.75  on 752  degrees of freedom
Residual deviance:  803.53  on 745  degrees of freedom
AIC: 819.53

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>A coluna <em>Estimate</em> mostra os coeficientes na forma de log da razão de chance. Quando a educação da mulher aumenta em uma unidade, a mudança esperada no log da razão de chance é de 0,22. Pode-se interpretar se os efeitos são positivos ou negativos, mas sua análise não é significativa. Aqui sabe-se que a educação tem efeito positivo na participação da mulher no mercado de trabalho, mas não sabemos de quanto!</p>
<p><strong>Razão de Chance</strong></p>
<p>Vamos agora calcular a razão de chance. Utilizaremos o pacote <code>mfx</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando o pacote mfx</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(mfx)){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"mfx"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(mfx)}</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">logitor</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6, <span class="at">data=</span>mroz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
logitor(formula = inlf ~ nwifeinc + educ + exper + I(exper^2) + 
    age + kidslt6 + kidsge6, data = mroz)

Odds Ratio:
           OddsRatio Std. Err.       z     P&gt;|z|    
nwifeinc   0.9788810 0.0082435 -2.5346  0.011256 *  
educ       1.2475360 0.0541921  5.0915 3.553e-07 ***
exper      1.2285929 0.0393847  6.4220 1.345e-10 ***
I(exper^2) 0.9968509 0.0010129 -3.1041  0.001909 ** 
age        0.9157386 0.0133450 -6.0403 1.538e-09 ***
kidslt6    0.2361344 0.0480729 -7.0898 1.343e-12 ***
kidsge6    1.0619557 0.0794229  0.8038  0.421539    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OU</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>logit.or<span class="ot">=</span><span class="fu">exp</span>(<span class="fu">coef</span>(logit))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>logit.or</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    nwifeinc        educ       exper  I(exper^2)         age 
  1.5302825   0.9788810   1.2475360   1.2285929   0.9968509   0.9157386 
    kidslt6     kidsge6 
  0.2361344   1.0619557 </code></pre>
</div>
</div>
<p><strong>Interpretação</strong></p>
<p>Quando a educação da mulher aumenta em uma unidade, as chances de y = 1 (dela participar do mercado de trabalho) aumentam em 24% ((1,247-1)*100). Ou a probabilidade de participar do mercado de trabalho (y = 1) é 1,24 vezes maior quando a educação aumenta em uma unidade (mantendo todas as outras variáveis constante).</p>
<p><strong>Efeito Marginal</strong></p>
<p>Utilizando o mesmo pacote anterior <code>mfx</code>, tem-se:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logitmfx</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6, <span class="at">data=</span>mroz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
logitmfx(formula = inlf ~ nwifeinc + educ + exper + I(exper^2) + 
    age + kidslt6 + kidsge6, data = mroz)

Marginal Effects:
                 dF/dx   Std. Err.       z     P&gt;|z|    
nwifeinc   -0.00519005  0.00204820 -2.5340  0.011278 *  
educ        0.05377731  0.01056074  5.0922 3.539e-07 ***
exper       0.05005693  0.00782462  6.3974 1.581e-10 ***
I(exper^2) -0.00076692  0.00024768 -3.0965  0.001959 ** 
age        -0.02140302  0.00353973 -6.0465 1.480e-09 ***
kidslt6    -0.35094982  0.04963897 -7.0700 1.549e-12 ***
kidsge6     0.01461621  0.01818832  0.8036  0.421625    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Interpretação</strong></p>
<p>Os efeitos marginais mostram a mudança na probabilidade quando <span class="math inline">\(X\)</span> aumenta em uma unidade. No nosso caso o aumento de 1 ano na educação da mulher aumenta em 0.053 pontos percentuais a probabilidade de a mulher participar do mercado de trabalho, <span class="math inline">\(Pr(Y=1)\)</span>. A probabilidade aqui é um valor entre 0 e 1.</p>
<p><strong>Calculando a Probabilidade</strong></p>
<p>Vamos calcular a probabilidade de uma mulher participar do mercado de trabalho. Predizendo a probabilidade:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> expersq <span class="sc">+</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>), <span class="at">data=</span>mroz)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># temos que fazer o inverso do modelo logit</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>invlogit<span class="ot">=</span><span class="cf">function</span> (x) {<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>x))}</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invlogit</span>(<span class="fu">coef</span>(logit)[<span class="dv">1</span>]<span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>nwifeinc)<span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">3</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>educ)<span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">4</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>exper)<span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">5</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>expersq)<span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">6</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>age)<span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">7</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>kidslt6)<span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">8</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>kidsge6))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   0.582772 </code></pre>
</div>
</div>
<p>Em média 58% das mulheres participam do mercado de trabalho. Vejamos agora para o caso das duas mulheres que haviamos feito anteriormente:</p>
<ul>
<li><strong>MULHER 1</strong>: renda familiar adicional de 50 mil ano, 7 anos de escolaridade, não tem experiência, com 25 anos e possui 2 filhos menores de 6 anos.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mulher 1</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>invlogit<span class="ot">=</span><span class="cf">function</span> (x) {<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>x))}</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invlogit</span>(<span class="fu">coef</span>(logit)[<span class="dv">1</span>]<span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">50</span><span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">3</span>]<span class="sc">*</span><span class="dv">7</span><span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">4</span>]<span class="sc">*</span><span class="dv">0</span><span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">5</span>]<span class="sc">*</span><span class="dv">0</span><span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">6</span>]<span class="sc">*</span><span class="dv">25</span><span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">7</span>]<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">8</span>]<span class="sc">*</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
 0.01505417 </code></pre>
</div>
</div>
<p>A chance da mulher descrita acima participar do mercado de trabalho é de 1,5%.</p>
<ul>
<li><strong>MULHER 2</strong>: Não tem renda adicional, 17 anos de escolaridade, 30 anos de experiência, com 52 anos e não possui filhos.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mulher 1</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>invlogit<span class="ot">=</span><span class="cf">function</span> (x) {<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>x))}</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invlogit</span>(<span class="fu">coef</span>(logit)[<span class="dv">1</span>]<span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">0</span><span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">3</span>]<span class="sc">*</span><span class="dv">17</span><span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">4</span>]<span class="sc">*</span><span class="dv">30</span><span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">5</span>]<span class="sc">*</span><span class="dv">900</span><span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">6</span>]<span class="sc">*</span><span class="dv">52</span><span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">7</span>]<span class="sc">*</span><span class="dv">0</span><span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">coef</span>(logit)[<span class="dv">8</span>]<span class="sc">*</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
  0.9500491 </code></pre>
</div>
</div>
<p>A chance da Mulher 2 participar do mercado de trabalho é de 95% .</p>
<p><strong>Graficamente</strong></p>
<p>Vejamos agora graficamente o efeito dos anos de estudo sobre a probabilidade de a mulher entrar no mercado de trabalho. Vamos manter as variáveis na média e vamos simular mulheres de 5 a 17 anos de estudo e estimar a probabilidde de ela participar da força de trabalho.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(ggplot2)){</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggplot2)}</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> expersq <span class="sc">+</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>), <span class="at">data=</span>mroz)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>amp_educ<span class="ot">&lt;-</span><span class="fu">range</span>(mroz<span class="sc">$</span>edu) </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>edu_sequence <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">5</span>, <span class="at">to =</span> <span class="dv">17</span>, <span class="at">by =</span> .<span class="dv">02</span>) <span class="co"># 177 points along x axis</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>constanteX <span class="ot">&lt;-</span> <span class="fu">with</span>(mroz, <span class="fu">data.frame</span>(<span class="at">nwifeinc=</span> <span class="fu">mean</span>(nwifeinc),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">exper=</span> <span class="fu">mean</span>(exper),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">expersq=</span> <span class="fu">mean</span>(expersq),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">age=</span> <span class="fu">mean</span>(age),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">kidslt6=</span> <span class="fu">mean</span>( kidslt6),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">kidsge6=</span> <span class="fu">mean</span>(kidsge6),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">educ =</span> edu_sequence </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                                  ))</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>constanteX<span class="sc">$</span>predicao <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> logit, </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">newdata =</span> constanteX, </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(constanteX, <span class="fu">aes</span>(<span class="at">x =</span> educ, <span class="at">y =</span> predicao)) <span class="sc">+</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probabilidade de Participação no Mercado de Trabalho"</span>, <span class="at">x =</span> <span class="st">"Anos de Estudo"</span>, <span class="at">y =</span> <span class="st">"Prob de Participação"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="outrosmodelos_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="probit" class="level4" data-number="9.1.3.2">
<h4 data-number="9.1.3.2" class="anchored" data-anchor-id="probit"><span class="header-section-number">9.1.3.2</span> Probit</h4>
<p>Uma alternativa ao modelo logit seria o uso do modelo probit. Que ao invés da função logística utiliza-se a função distribuição normal padrão. Vejamos os resultados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mroz, <span class="at">package=</span><span class="st">"wooldridge"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Modelo logit, familia da binomial = logit</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6 , <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>), <span class="at">data=</span>mroz)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>probit <span class="ot">&lt;-</span> <span class="fu">glm</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6 , <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"probit"</span>), <span class="at">data=</span>mroz)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(logit,probit, <span class="at">type=</span><span class="st">"text"</span>,<span class="at">keep.stat=</span><span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=========================================
                 Dependent variable:     
             ----------------------------
                         inlf            
                logistic       probit    
                  (1)            (2)     
-----------------------------------------
nwifeinc        -0.021**      -0.012**   
                (0.008)        (0.005)   
                                         
educ            0.221***      0.131***   
                (0.043)        (0.025)   
                                         
exper           0.206***      0.123***   
                (0.032)        (0.019)   
                                         
I(exper2)      -0.003***      -0.002***  
                (0.001)        (0.001)   
                                         
age            -0.088***      -0.053***  
                (0.015)        (0.008)   
                                         
kidslt6        -1.443***      -0.868***  
                (0.204)        (0.118)   
                                         
kidsge6          0.060          0.036    
                (0.075)        (0.044)   
                                         
Constant         0.425          0.270    
                (0.860)        (0.508)   
                                         
-----------------------------------------
Observations      753            753     
=========================================
Note:         *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Observe que sinal e significância estão em acordo entre os dois modelos. Vejamos agora os efeitos marginais para podermos comparar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logitmfx</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6, <span class="at">data=</span>mroz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
logitmfx(formula = inlf ~ nwifeinc + educ + exper + I(exper^2) + 
    age + kidslt6 + kidsge6, data = mroz)

Marginal Effects:
                 dF/dx   Std. Err.       z     P&gt;|z|    
nwifeinc   -0.00519005  0.00204820 -2.5340  0.011278 *  
educ        0.05377731  0.01056074  5.0922 3.539e-07 ***
exper       0.05005693  0.00782462  6.3974 1.581e-10 ***
I(exper^2) -0.00076692  0.00024768 -3.0965  0.001959 ** 
age        -0.02140302  0.00353973 -6.0465 1.480e-09 ***
kidslt6    -0.35094982  0.04963897 -7.0700 1.549e-12 ***
kidsge6     0.01461621  0.01818832  0.8036  0.421625    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">probitmfx</span>(inlf<span class="sc">~</span> nwifeinc <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                  age<span class="sc">+</span> kidslt6 <span class="sc">+</span> kidsge6, <span class="at">data=</span>mroz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
probitmfx(formula = inlf ~ nwifeinc + educ + exper + I(exper^2) + 
    age + kidslt6 + kidsge6, data = mroz)

Marginal Effects:
                 dF/dx   Std. Err.       z     P&gt;|z|    
nwifeinc   -0.00469619  0.00192965 -2.4337  0.014945 *  
educ        0.05112843  0.00992310  5.1525 2.571e-07 ***
exper       0.04817690  0.00734505  6.5591 5.413e-11 ***
I(exper^2) -0.00073705  0.00023464 -3.1412  0.001683 ** 
age        -0.02064309  0.00330485 -6.2463 4.203e-10 ***
kidslt6    -0.33914996  0.04634765 -7.3175 2.526e-13 ***
kidsge6     0.01406306  0.01719895  0.8177  0.413546    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Interpretando</strong></p>
<p>O aumento de 1 ano na educação da mulher aumenta em 0.053 pontos percentuais a probabilidade de a mulher participar do mercado de trabalho, <span class="math inline">\(Pr(Y=1)\)</span>, no modelo logit e 0.051 no modelo probit. As diferenças são pequenas entre os dois modelos.</p>
</section>
</section>
</section>
<section id="dados-de-contagem-modelo-de-regressão-de-poisson" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="dados-de-contagem-modelo-de-regressão-de-poisson"><span class="header-section-number">9.2</span> Dados de Contagem: Modelo de Regressão de Poisson</h2>
<p>Em vez de apenas dados binários codificados em <span class="math inline">\(0/1\)</span>, os dados de contagem podem assumir qualquer número inteiro não negativo $0,1,2,. . $.</p>
<p>Se considerarem números muito grandes (como o número de alunos numa escola, número de dias de duração de um processo), podem ser aproximados por variáveis contínuas em modelos lineares e estimados utilizando MQO. Se os números forem relativamente pequenos (como o número de filhos de uma mãe), esta aproximação pode não funcionar bem. Por exemplo, os valores previstos podem tornar-se negativos.</p>
<p>O modelo de regressão de Poisson é o modelo mais básico e conveniente projetado explicitamente para dados de contagem. A probabilidade de y assumir qualquer valor <span class="math inline">\(h \in \{0,1,2,..\}\)</span> e o modelo pode ser escrito da seguinte maneira:</p>
<p><span class="math display">\[P(y = h \mid x) = \frac{e^{-e^{\mathbf{x} \boldsymbol{\beta}}} (e^{\mathbf{x} \boldsymbol{\beta}})^h}{h!}\]</span></p>
<p>Os parâmetros do modelo de Poisson são muito mais fáceis de interpretar do que os de um modelo probit ou logit. Neste modelo, a média condicional de y é</p>
<p><span class="math display">\[E(y \mid x) = e^{\mathbf{x} \boldsymbol{\beta}}\]</span></p>
<p>então cada parâmetro de inclinação <span class="math inline">\(\beta_j\)</span> tem a interpretação de uma semielasticidade:</p>
<p><span class="math display">\[\frac{\partial E(y \mid x)}{\partial x_j} = \beta_j \cdot e^{\mathbf{x} \boldsymbol{\beta}} = \beta_j \cdot E(y \mid x)\]</span></p>
<p>Logo,</p>
<p><span class="math display">\[\beta_j = \frac{1}{E(y \mid x)} \cdot \frac{\partial E(y \mid x)}{\partial x_j}\]</span></p>
<p><span class="math display">\[\beta_j \Delta{X}= \frac{\Delta E(y \mid x)}{E(y \mid x)}=E(y \mid x)\%\]</span> <strong>Interpretação</strong></p>
<p>Se <span class="math inline">\(x_j\)</span> aumentar em uma unidade (tudo mais constante), <span class="math inline">\(E(y|x)\)</span> aumentará aproximadamente em <span class="math inline">\(100 \cdot \beta_j\)</span> por cento (o valor exato é novamente <span class="math inline">\(100 \cdot (e^{\beta_j} - 1)\)</span>).</p>
<section id="exemplo" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="exemplo"><span class="header-section-number">9.2.1</span> Exemplo:</h3>
<p>Estimar modelos de regressão de Poisson em R é simples. Eles também pertencem à classe dos modelos lineares generalizados (GLM) e podem ser estimados usando <code>glm</code>. A opção para especificar um modelo de Poisson é <code>family=poisson</code>.</p>
<p>Vejamos um exemplo que analisa o número de prisões masculinas em 1986. Estamos estudando o número de vezes que um homem foi preso no ano de 1986 - <em>narr86</em>. As variáveis independentes são:</p>
<ul>
<li>pcnv: proporção de condenações anteriores</li>
<li>avgsen: comprimento médio da sentença.</li>
<li>tottime: tempo de prisão desde os 18 (mês)</li>
<li>ptime86: mos. na prisão em 1986</li>
<li>qemp86: trimestres empregados, 1986</li>
<li>inc86: renda legal, 1986, US$ 100</li>
<li>black: =1 se preto</li>
<li>hispn: =1 se for hispânico</li>
<li>born60: =1 se nasceu em 1960</li>
</ul>
<p>Para ajudar a compreender a diferença entre a interpretação do modelo de regressão de Poisson e o modelo linerar, vamos estimar os dois abaixo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(crime1, <span class="at">package=</span><span class="st">"wooldridge"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimando o modelo de Poisson</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>Poisson.res <span class="ot">&lt;-</span> <span class="fu">glm</span>(narr86<span class="sc">~</span>pcnv<span class="sc">+</span>avgsen<span class="sc">+</span>tottime<span class="sc">+</span>ptime86<span class="sc">+</span>qemp86<span class="sc">+</span>inc86<span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>black<span class="sc">+</span>hispan<span class="sc">+</span>born60, <span class="at">data=</span>crime1, <span class="at">family=</span>poisson)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#estimando o modelo OLS</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>lm.res <span class="ot">&lt;-</span> <span class="fu">lm</span>(narr86<span class="sc">~</span>pcnv<span class="sc">+</span>avgsen<span class="sc">+</span>tottime<span class="sc">+</span>ptime86<span class="sc">+</span>qemp86<span class="sc">+</span>inc86<span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>black<span class="sc">+</span>hispan<span class="sc">+</span>born60, <span class="at">data=</span>crime1)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(Poisson.res,lm.res, <span class="at">type=</span><span class="st">"text"</span>,<span class="at">keep.stat=</span><span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=========================================
                 Dependent variable:     
             ----------------------------
                        narr86           
                Poisson          OLS     
                  (1)            (2)     
-----------------------------------------
pcnv           -0.402***      -0.132***  
                (0.085)        (0.040)   
                                         
avgsen           -0.024        -0.011    
                (0.020)        (0.012)   
                                         
tottime          0.024*         0.012    
                (0.015)        (0.009)   
                                         
ptime86        -0.099***      -0.041***  
                (0.021)        (0.009)   
                                         
qemp86           -0.038       -0.051***  
                (0.029)        (0.014)   
                                         
inc86          -0.008***      -0.001***  
                (0.001)       (0.0003)   
                                         
black           0.661***      0.327***   
                (0.074)        (0.045)   
                                         
hispan          0.500***      0.194***   
                (0.074)        (0.040)   
                                         
born60           -0.051        -0.022    
                (0.064)        (0.033)   
                                         
Constant       -0.600***      0.577***   
                (0.067)        (0.038)   
                                         
-----------------------------------------
Observations     2,725          2,725    
=========================================
Note:         *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p><strong>Interpretando</strong></p>
<p>{No modelo de OLS}{.underline} um aumento de 0.10 na proporção de condenação reduz o número de prisões em 0.13 unidades.</p>
<p>{No modelo de Poisson}{.underline} um aumento de 0.10 na proporção de condenação reduz em <span class="math inline">\(0,402 \cdot 0,1 \cdot 100=4,02\%\)</span>. Considerando a cor da pele, aquelas que declaram ter pele preta possuem 66% mais chance de serem presas.</p>
</section>
</section>
<section id="modelo-com-dados-em-painel-modelos-de-efeitos-fixos" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="modelo-com-dados-em-painel-modelos-de-efeitos-fixos"><span class="header-section-number">9.3</span> Modelo com Dados em Painel: Modelos de Efeitos Fixos</h2>
<p>Dados em painel são extremamente importantes na análise econométrica porque permitem o estudo de variáveis ao longo do tempo e entre diferentes indivíduos ou entidades, como empresas, países ou varas. Esse tipo de dados oferece mais informações, variabilidade e eficiência do que séries temporais ou dados cross-section isoladamente, permitindo uma melhor compreensão das dinâmicas subjacentes e das relações causais.</p>
<p>O estimador de efeitos fixos é uma técnica crucial para lidar com o viés de heterogeneidade, que surge quando características não observáveis e invariantes no tempo influenciam as variáveis de interesse. Ao considerar apenas as variações dentro de cada indivíduo ao longo do tempo, o estimador de efeitos fixos controla essas características não observáveis, eliminando seu impacto sobre os estimadores dos coeficientes. Dessa forma, permite uma estimativa não enviesada dos efeitos das variáveis explicativas, proporcionando resultados mais robustos e confiáveis.</p>
<p>Considere o modelo mais simples de T períodos.</p>
<p><span class="math display">\[y_{it} = \beta_0 + \beta_1 x_{it1} + \beta_2 x_{it2} + \cdots + \beta_k x_{itk} + a_i + u_{it}\]</span></p>
<p>Note que temos agora 3 subscritos, <span class="math inline">\(i\)</span>,<span class="math inline">\(t\)</span> e <span class="math inline">\(k\)</span>. O subscrito <span class="math inline">\(i\)</span> é a unidade de corte transversal (o município, a vara, o processo), <span class="math inline">\(t\)</span> representa o período dessa variável, e <span class="math inline">\(k\)</span> a variável que estamos obversando. O termo <span class="math inline">\(a_i\)</span> é denominado efeito fixo, pois é invariante no tempo. Ele capta uma série de fatores individuais não observados que impactam <span class="math inline">\(Y\)</span> mas que são invariantes no tempo.</p>
<p>Se aplicarmos o método de MQO na equação acima, teremos estimadores viesados e inconsistentes. Logo, precisamos remover esse efeito fixo. Uma forma de resolver isso é subtrair a média de cada variável para cada individuo ao longo do tempo. É então aplicar o MQO. Como <span class="math inline">\(a_i\)</span> é invariante sua média também é <span class="math inline">\(a_i\)</span>, e ao realizarmos a subtração removeremos o efeito fixo.</p>
<p><span class="math display">\[\bar{y_i} = \beta_0 + \beta_1 \bar{x}_{i1} + \cdots + \beta_k \bar{x}_{ik} + a_i + \bar{u}_i\]</span></p>
<p>O modelo transfromado é dado por:</p>
<p><span class="math display">\[\ddot{y}_{it} = y_{it} - \bar{y}_i = \beta_1 \ddot{x}_{it1} + \cdots + \beta_k \ddot{x}_{itk} + \ddot{u}_{it}\]</span> ### Exemplo:</p>
<p>Vamos utilizar para exemplificar um modelo simples de dois períodos. Estamos interessados em analisar o efeito do desemprego (<em>unem</em>) sobre a criminalidade (<em>crmrte</em>) em 46 cidades para os anos de 1982 e 1987. Usaremos o pacote <code>plm</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(plm)){</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"plm"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(plm)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: plm</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(crime2, <span class="at">package=</span><span class="st">"wooldridge"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>crime2.p <span class="ot">&lt;-</span> <span class="fu">pdata.frame</span>(crime2, <span class="at">index=</span><span class="dv">46</span> )</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="do">##Estimando o modelo</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>Painel<span class="ot">&lt;-</span> <span class="fu">plm</span>(crmrte<span class="sc">~</span>unem <span class="sc">+</span>  d87, <span class="at">data=</span>crime2.p, <span class="at">model=</span><span class="st">"within"</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Painel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = crmrte ~ unem + d87, data = crime2.p, model = "within")

Balanced Panel: n = 46, T = 2, N = 92

Residuals:
   Min. 1st Qu.  Median 3rd Qu.    Max. 
-26.458  -6.384   0.000   6.384  26.458 

Coefficients:
     Estimate Std. Error t-value Pr(&gt;|t|)   
unem  2.21800    0.87787  2.5266  0.01519 * 
d87  15.40220    4.70212  3.2756  0.00206 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    11002
Residual Sum of Squares: 8844.8
R-Squared:      0.19606
Adj. R-Squared: -0.66269
F-statistic: 5.36528 on 2 and 44 DF, p-value: 0.0082206</code></pre>
</div>
</div>
<p>Observa-se nesse modelo que o aumento de 1 na taxa de desemprego aumenta em 2.2 pontos a taxa de criminalidade. Observa-se que as características dos munícipios que são fixas no tempo estão sendo controladas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Estimando o modelo</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>Painelln<span class="ot">&lt;-</span> <span class="fu">plm</span>(lcrmrte<span class="sc">~</span><span class="fu">I</span>(<span class="fu">log</span>(unem)) <span class="sc">+</span>  d87, <span class="at">data=</span>crime2.p, <span class="at">model=</span><span class="st">"within"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Painelln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = lcrmrte ~ I(log(unem)) + d87, data = crime2.p, 
    model = "within")

Balanced Panel: n = 46, T = 2, N = 92

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-2.3912e-01 -6.9878e-02  1.8648e-17  6.9878e-02  2.3912e-01 

Coefficients:
             Estimate Std. Error t-value Pr(&gt;|t|)  
I(log(unem)) 0.164799   0.071263  2.3125  0.02549 *
d87          0.121119   0.045288  2.6744  0.01047 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    0.84604
Residual Sum of Squares: 0.72674
R-Squared:      0.141
Adj. R-Squared: -0.77656
F-statistic: 3.61129 on 2 and 44 DF, p-value: 0.035303</code></pre>
</div>
</div>
<p>Usando a taxa de crime e desemprego em <em>ln</em>, um aumento de 1% no desemprego aumenta em 0,16% a taxa de crime nos municípios.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lineares.html" class="pagination-link" aria-label="Modelos Lineares">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelos Lineares</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>